* { margin: 0; padding: 0; box-sizing: border-box; -webkit-tap-highlight-color: transparent; }
    :root { --bg-dark: #0a0a0f; --safe-top: env(safe-area-inset-top, 20px); --safe-bottom: env(safe-area-inset-bottom, 20px); --nav-height: calc(60px + env(safe-area-inset-bottom, 20px)); }
    html, body { height: 100%; width: 100%; overflow: hidden; font-family: 'Plus Jakarta Sans', -apple-system, BlinkMacSystemFont, sans-serif; background: var(--bg-dark); color: #ffffff; position: fixed; text-transform: lowercase; }
    button, select { text-transform: inherit; }

    /* Preserve original casing for user-created content */
    .task-text, input, textarea,
    .room-card .info h2, .room-card .info p,
    .cubby-card .name, .cubby-title h1,
    .subcubby-header h3,
    .cubby-description,
    .archive-item-name, .archive-item-source,
    .search-result-text, .search-result-location,
    .view-task-text-group .task-text,
    .view-task-location,
    .settings-user-info,
    .task-memo-display,
    .move-subcubby, .move-path,
    .location-path,
    .location-picker-item,
    .location-picker-room,
    .cubby-room-option,
    .confirm-message { text-transform: none; }
    .screen { height: 100%; width: 100%; display: none; flex-direction: column; overflow: hidden; position: absolute; top: 0; left: 0; }
    .screen.active { display: flex; }
    @keyframes slideIn { from { opacity: 0; transform: translateY(20px); } to { opacity: 1; transform: translateY(0); } }
    @keyframes checkPop { 0% { transform: scale(1); } 30% { transform: scale(1.3); } 60% { transform: scale(0.9); } 100% { transform: scale(1); } }
    .animate-in { animation: slideIn 0.3s ease forwards; }
    .delay-1 { animation-delay: 0.05s; opacity: 0; }
    .delay-2 { animation-delay: 0.1s; opacity: 0; }
    .delay-3 { animation-delay: 0.15s; opacity: 0; }
    #home-screen { padding: calc(var(--safe-top) + 20px) 20px var(--nav-height); background: #0a0a0f; overflow-y: auto; }
    .home-header { display: flex; justify-content: space-between; align-items: flex-start; margin-bottom: 24px; }
    .greeting h1 { font-size: 32px; font-weight: 800; margin-bottom: 4px; }
    .greeting p { font-size: 16px; color: rgba(255,255,255,0.5); font-weight: 500; }
    #greeting-date { font-size: 14px; color: rgba(255,255,255,0.35); font-weight: 500; margin-top: 2px; }
    .home-header-actions { display: flex; gap: 8px; }
    .home-edit-btn { padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; color: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.2s ease; }
    .home-edit-btn:hover { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.6); }
    .home-edit-btn:active { transform: scale(0.95); }
    .home-edit-btn.active { background: rgba(107, 163, 255, 0.15); border-color: rgba(107, 163, 255, 0.3); color: #6ba3ff; }
    .signout-btn { padding: 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.08); border-radius: 12px; color: rgba(255,255,255,0.4); cursor: pointer; transition: all 0.2s ease; }
    .signout-btn:hover { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.6); }
    .signout-btn:active { transform: scale(0.95); }

    /* Home Edit Mode */
    .home-section-wrapper { position: relative; transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1); }
    .home-section-wrapper.editing { padding: 16px; background: rgba(255,255,255,0.02); border: 2px dashed rgba(255,255,255,0.1); border-radius: 16px; margin-bottom: 20px; }
    .home-widget-grid.editing { padding: 16px; background: rgba(255,255,255,0.02); border: 2px dashed rgba(255,255,255,0.1); border-radius: 16px; margin-bottom: 20px; }
    .home-section-wrapper.editing.hidden { opacity: 0.4; }
    .home-section-controls { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; }
    .home-section-label-text { flex: 1; font-size: 12px; font-weight: 700; color: rgba(255,255,255,0.5); letter-spacing: 0.5px; }
    .home-section-control-btn { padding: 6px 10px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: rgba(255,255,255,0.4); cursor: pointer; font-size: 11px; font-weight: 600; font-family: inherit; transition: all 0.2s ease; display: flex; align-items: center; gap: 4px; }
    .home-section-control-btn:hover { background: rgba(255,255,255,0.08); color: rgba(255,255,255,0.6); }
    .home-section-control-btn:active { transform: scale(0.92); }
    .home-section-control-btn.disabled { opacity: 0.3; pointer-events: none; }
    .home-section-control-btn svg { width: 14px; height: 14px; }
    .home-section-drag-handle { display: flex; align-items: center; justify-content: center; width: 28px; height: 28px; color: rgba(255,255,255,0.25); cursor: grab; border-radius: 6px; transition: all 0.2s ease; flex-shrink: 0; }
    .home-section-drag-handle:hover { color: rgba(255,255,255,0.5); background: rgba(255,255,255,0.05); }
    .home-section-drag-handle:active { cursor: grabbing; }
    .widget-grid-controls { display: none; }
    .home-edit-banner { background: rgba(107, 163, 255, 0.1); border: 1px solid rgba(107, 163, 255, 0.2); border-radius: 16px; padding: 16px; margin-bottom: 24px; display: flex; align-items: center; justify-content: space-between; }
    .home-edit-banner-text { font-size: 13px; font-weight: 600; color: #6ba3ff; }
    .home-edit-done-btn { padding: 8px 16px; background: rgba(107, 163, 255, 0.15); border: 1px solid rgba(107, 163, 255, 0.3); border-radius: 10px; color: #6ba3ff; cursor: pointer; font-size: 13px; font-weight: 700; font-family: inherit; transition: all 0.2s ease; }
    .home-edit-done-btn:hover { background: rgba(107, 163, 255, 0.25); }
    .home-edit-done-btn:active { transform: scale(0.92); }

    /* Dashboard Stats */
    .dashboard-stats { display: grid; grid-template-columns: 2fr 1fr 1fr 1fr 1fr; gap: 10px; margin-bottom: 24px; }
    .dashboard-stat-card { display: flex; flex-direction: column; align-items: center; justify-content: center; padding: 16px 8px; border-radius: 16px; border: 2px solid transparent; transition: all 0.2s ease; }
    .dashboard-stat-card.today-stat { flex-direction: row; gap: 8px; padding: 16px 16px; }
    .dashboard-stat-card.today-stat .stat-count { font-size: 42px; margin-bottom: 0; }
    .dashboard-stat-card.today-stat .stat-label { font-size: 14px; font-weight: 700; letter-spacing: 0.5px; }
    .dashboard-stat-card:hover { filter: brightness(1.2); }
    .dashboard-stat-card:active { transform: scale(0.95); }
    .dashboard-stat-card.empty { opacity: 0.3; filter: saturate(0.5); cursor: default !important; pointer-events: none; border-width: 1px; }
    .dashboard-stat-card.empty:hover { filter: saturate(0.5); }
    .dashboard-stat-card.empty:active { transform: none; }
    .dashboard-stat-card.overdue-stat { animation: pulseBorderRed 1s cubic-bezier(0.4, 0, 0.2, 1) 3, pulseBgRed 1s cubic-bezier(0.4, 0, 0.2, 1) 3; }
    @keyframes pulseBorderRed {
        0%, 55% { border-color: rgba(255, 107, 107, 0.25); }
        64% { border-color: #c1121f; }
        100% { border-color: rgba(255, 107, 107, 0.25); }
    }
    @keyframes pulseBgRed {
        0%, 55% { background: rgba(255,255,255,0.03); }
        64% { background: rgba(193, 18, 31, 0.15); }
        72% { background: rgba(193, 18, 31, 0.08); }
        85% { background: rgba(255,255,255,0.05); }
        100% { background: rgba(255,255,255,0.03); }
    }
    .stat-count { font-size: 28px; font-weight: 800; line-height: 1; margin-bottom: 4px; }
    .stat-count.overdue-count { animation: pulseColorRed 1s cubic-bezier(0.4, 0, 0.2, 1) 3; }
    @keyframes pulseColorRed {
        0%, 55% { color: #ff6b6b; }
        64% { color: #ff3333; }
        100% { color: #ff6b6b; }
    }
    .stat-label { font-size: 11px; font-weight: 600; opacity: 0.8; letter-spacing: 0.3px; }

    /* Dashboard Upcoming */
    .dashboard-upcoming { margin-bottom: 24px; }
    .dashboard-upcoming-header { display: flex; align-items: center; justify-content: space-between; margin-bottom: 12px; }
    .upcoming-title { font-size: 13px; font-weight: 800; color: rgba(255,255,255,0.4); letter-spacing: 0.5px; }
    .upcoming-see-all { background: none; border: none; color: rgba(255,255,255,0.3); font-size: 12px; font-weight: 600; cursor: pointer; padding: 4px 8px; border-radius: 8px; font-family: inherit; transition: all 0.2s ease; }
    .upcoming-see-all:hover { color: rgba(255,255,255,0.6); background: rgba(255,255,255,0.05); }
    .upcoming-task { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: rgba(255,255,255,0.03); border: 2px solid rgba(255,255,255,0.06); border-radius: 12px; margin-bottom: 6px; cursor: pointer; transition: all 0.2s ease; }
    .upcoming-task:hover { background: rgba(255,255,255,0.05); border-color: rgba(255,255,255,0.1); }
    .upcoming-task:active { transform: scale(0.98); }
    .upcoming-cubby-dot { width: 8px; height: 8px; border-radius: 50%; flex-shrink: 0; }
    .upcoming-task-info { flex: 1; display: flex; flex-direction: column; gap: 2px; min-width: 0; }
    .upcoming-task-text { font-size: 14px; font-weight: 500; color: rgba(255,255,255,0.8); white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .upcoming-cubby-name { font-size: 11px; font-weight: 600; opacity: 0.7; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    .upcoming-due-pill { font-size: 11px; font-weight: 600; padding: 4px 10px; border-radius: 8px; border: 1px solid transparent; white-space: nowrap; flex-shrink: 0; }
    .upcoming-no-date { color: rgba(255,255,255,0.25); background: rgba(255,255,255,0.03); border-color: rgba(255,255,255,0.06); }
    .upcoming-hidden { display: none; }
    .upcoming-see-more { width: 100%; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); color: rgba(255,255,255,0.4); font-size: 13px; font-weight: 600; cursor: pointer; padding: 10px; border-radius: 10px; font-family: inherit; transition: all 0.2s ease; margin-top: 2px; }
    .upcoming-see-more:hover { color: rgba(255,255,255,0.6); background: rgba(255,255,255,0.05); }
    .upcoming-see-more:active { transform: scale(0.98); }
    .upcoming-empty { text-align: center; padding: 24px 16px; color: rgba(255,255,255,0.25); font-size: 14px; font-weight: 500; background: rgba(255,255,255,0.02); border-radius: 16px; border: 1px dashed rgba(255,255,255,0.06); }

    /* Home Widget Grid & Cards */
    .home-widget-grid { display: contents; }
    .widget-card-header { display: none; }
    .desktop-only { display: none; }

    /* Dashboard Quick Actions */
    .dashboard-quick-actions { display: grid; grid-template-columns: repeat(4, 1fr); gap: 10px; margin-bottom: 28px; }
    .quick-action-btn { display: flex; flex-direction: column; align-items: center; gap: 10px; padding: 18px 8px; background: rgba(255,255,255,0.03); border: 1px solid rgba(255,255,255,0.06); border-radius: 16px; cursor: pointer; transition: all 0.2s ease; font-family: inherit; }
    .quick-action-btn:hover { background: rgba(255,255,255,0.06); border-color: rgba(255,255,255,0.1); }
    .quick-action-btn:active { transform: scale(0.92); }
    .quick-action-icon { width: 44px; height: 44px; border-radius: 14px; display: flex; align-items: center; justify-content: center; }
    .quick-action-btn span { font-size: 11px; font-weight: 600; color: rgba(255,255,255,0.5); }

    /* Dashboard Section Labels */
    .dashboard-section-label { font-size: 13px; font-weight: 700; color: rgba(255,255,255,0.4); letter-spacing: 0.5px; margin-bottom: 12px; }

    /* Cubbies Browse Screen */
    #cubbies-screen { padding: calc(var(--safe-top) + 20px) 20px var(--nav-height); background: #0a0a0f; overflow-y: auto; }
    .cubbies-browse-title { margin-bottom: 24px; }
    .cubbies-browse-title h1 { font-size: 32px; font-weight: 800; }
    .cubbies-browse-container { padding-bottom: 40px; }
    .cubbies-browse-section { border-radius: 20px; border: 2px solid rgba(255,255,255,0.06); background: rgba(255,255,255,0.02); margin-bottom: 16px; overflow: hidden; }
    .cubbies-browse-section-header { display: flex; align-items: center; padding: 20px 20px 16px; cursor: pointer; transition: all 0.2s ease; }
    .cubbies-browse-section-header:active { background: rgba(255,255,255,0.02); }
    .cubbies-browse-section-info { flex: 1; }
    .cubbies-browse-section-info h2 { font-size: 20px; font-weight: 700; margin-bottom: 2px; }
    .cubbies-browse-count { font-size: 13px; font-weight: 500; color: rgba(255,255,255,0.4); }
    .cubbies-browse-arrow { color: rgba(255,255,255,0.3); flex-shrink: 0; }
    .cubbies-browse-list { padding: 0 12px 12px; }
    .cubbies-browse-item { display: flex; align-items: center; gap: 12px; padding: 14px 16px; border-radius: 14px; cursor: pointer; transition: all 0.2s ease; margin-bottom: 5px; }
    .cubbies-browse-item:hover { filter: brightness(1.15); }
    .cubbies-browse-item:active { transform: scale(0.98); }
    .cubbies-browse-item:last-child { margin-bottom: 0; }
    .cubbies-browse-dot { width: 10px; height: 10px; border-radius: 50%; flex-shrink: 0; }
    .cubbies-browse-name { flex: 1; font-size: 16px; font-weight: 600; }
    .cubbies-browse-task-count { font-size: 11px; font-weight: 600; flex-shrink: 0; padding: 4px 6px; border-radius: 8px; background: rgba(0,0,0,0.3); display: flex; align-items: center; justify-content: center; width: 36px; }
    .cubbies-browse-item-arrow { flex-shrink: 0; opacity: 0.5; }
    .cubbies-browse-add { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 20px; margin-bottom: 16px; background: rgba(255,255,255,0.02); border-radius: 20px; border: 1px dashed rgba(255,255,255,0.1); cursor: pointer; opacity: 0.6; transition: all 0.2s ease; }
    .cubbies-browse-add:hover { opacity: 1; background: rgba(255,255,255,0.04); }
    .cubbies-browse-add .plus { color: rgba(255,255,255,0.5); font-size: 18px; font-weight: 600; }
    .cubbies-browse-add .text { color: rgba(255,255,255,0.4); font-size: 16px; font-weight: 500; }
    .cubbies-browse-empty { text-align: center; padding: 40px 20px; color: rgba(255,255,255,0.25); font-size: 14px; font-weight: 500; }

    .room-card { margin-bottom: 16px; background: rgba(255,255,255,0.03); border-radius: 20px; border: 2px solid rgba(255,255,255,0.06); display: flex; align-items: center; transition: all 0.2s ease; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .room-card.room-colored { background: rgba(0,0,0,0.4); }
    .room-card-main { flex: 1; padding: 24px; cursor: pointer; display: flex; align-items: center; gap: 16px; }
    .room-card-main:active { background: rgba(255,255,255,0.02); border-radius: 20px 0 0 20px; }
    .room-card .info h2 { font-size: 24px; font-weight: 700; margin-bottom: 4px; display: flex; align-items: center; }
    .room-card .info p { font-size: 14px; color: rgba(255,255,255,0.4); font-weight: 500; }
    .room-card .arrow { margin-left: auto; color: rgba(255,255,255,0.3); }
    .room-card .arrow svg { transition: stroke 0.06s ease; }
    .room-more-btn { padding: 24px 20px; cursor: pointer; color: rgba(255,255,255,0.3); opacity: 0.6; transition: opacity 0.2s ease; }
    .room-more-btn:hover { opacity: 1; }
    .room-menu-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99; }
    
    /* Add room button */
    .add-room-btn { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 24px; margin-bottom: 16px; background: rgba(255,255,255,0.02); border-radius: 20px; border: 1px dashed rgba(255,255,255,0.1); cursor: pointer; opacity: 0.6; transition: all 0.2s ease; }
    .add-room-btn:hover { opacity: 1; background: rgba(255,255,255,0.04); }
    .add-room-btn .plus { color: rgba(255,255,255,0.5); font-size: 18px; font-weight: 600; }
    .add-room-btn .text { color: rgba(255,255,255,0.4); font-size: 16px; font-weight: 500; }
    
    .logo { text-align: center; padding: 40px 20px; }
    .logo span { font-size: 14px; font-weight: 700; color: rgba(255,255,255,0.15); letter-spacing: 2px; }
    #room-screen { padding: calc(var(--safe-top) + 12px) 16px var(--nav-height); background: #0a0a0f; overflow: hidden; }
    .header { display: flex; align-items: center; gap: 12px; margin-bottom: 24px; }
    .back-btn { padding: 10px 16px; background: rgba(255,255,255,0.05); border-radius: 12px; border: 1px solid rgba(255,255,255,0.08); cursor: pointer; display: flex; align-items: center; gap: 8px; color: rgba(255,255,255,0.6); font-size: 14px; font-weight: 600; font-family: inherit; }
    .back-btn:active { background: rgba(255,255,255,0.1); }
    .room-title { display: flex; align-items: center; gap: 12px; margin-bottom: 24px; }
    .room-title h1 { font-size: 32px; font-weight: 800; }
    .cubbies-list { flex: 1; overflow-y: auto; display: flex; flex-direction: column; gap: 12px; padding-bottom: 40px; }
    .cubby-card { padding: 20px 24px; border-radius: 16px; cursor: pointer; display: flex; align-items: center; gap: 16px; transition: all 0.2s ease; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .cubby-card:active { transform: scale(0.98); }
    .cubby-card .name { font-size: 20px; font-weight: 700; }
    .cubby-card .arrow { margin-left: auto; }
    #cubby-screen { padding: calc(var(--safe-top) + 12px) 16px var(--nav-height); overflow: hidden; }
    .cubby-header { display: flex; align-items: center; gap: 12px; margin-bottom: 20px; }
    .cubby-header .back-btn { background: var(--cubby-card); border-color: var(--cubby-border); color: var(--cubby-text); }
    .cubby-header .back-btn:hover { background: var(--cubby-card-hover); }
    .cubby-settings-btn { padding: 10px; background: var(--cubby-card); border-radius: 12px; border: 1px solid var(--cubby-border); cursor: pointer; color: var(--cubby-text-muted); display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; font-family: inherit; }
    .cubby-settings-btn:hover { background: var(--cubby-card-hover); color: var(--cubby-text); }
    .cubby-settings-btn:active { transform: scale(0.9); }
    .new-task-btn { margin-left: auto; padding: 10px 16px; background: var(--cubby-card); border-radius: 12px; border: 1px solid var(--cubby-border); cursor: pointer; display: flex; align-items: center; gap: 8px; font-family: inherit; }
    .new-task-btn .plus { color: var(--cubby-primary); font-size: 16px; font-weight: 700; }
    .new-task-btn .text { color: var(--cubby-text); font-size: 14px; font-weight: 600; }
    .cubby-title { display: flex; flex-direction: column; gap: 4px; margin-bottom: 24px; }
    .cubby-title h1 { font-size: 36px; font-weight: 800; color: var(--cubby-text); display: flex; align-items: center; }
    .cubby-description { font-size: 14px; font-weight: 500; color: var(--cubby-text-muted); line-height: 1.4; }
    .tasks-container { flex: 1; overflow-y: auto; padding-bottom: 40px; }
    .subcubby { margin-bottom: 24px; }
    .subcubby-header { display: flex; align-items: center; gap: 8px; margin-bottom: 12px; cursor: pointer; user-select: none; }
    .subcubby-header .chevron { transition: transform 0.3s ease; color: var(--cubby-primary); }
    .subcubby-header.collapsed .chevron { transform: rotate(0deg); }
    .subcubby-header.expanded .chevron { transform: rotate(90deg); }
    .subcubby-header h3 { font-size: 14px; font-weight: 700; color: var(--cubby-primary); text-transform: none; letter-spacing: 0.5px; }
    .subcubby-header .count { font-size: 12px; color: var(--cubby-text-muted); font-weight: 500; }
    .subcubby-tasks { display: grid; grid-template-rows: 0fr; transition: grid-template-rows 0.3s ease, opacity 0.3s ease; opacity: 0; }
    .subcubby-tasks.visible { grid-template-rows: 1fr; opacity: 1; }
    .subcubby-tasks-inner { overflow: hidden; padding: 0 4px; margin: 0 -4px; }
    .task { display: flex; align-items: center; gap: 12px; padding: 14px 16px; margin-bottom: 8px; background: var(--cubby-card); border-radius: 12px; border: 1px solid transparent; transition: all 0.2s ease; backdrop-filter: blur(12px); -webkit-backdrop-filter: blur(12px); }
    .task.expanded { background: var(--cubby-card-hover); border-color: var(--cubby-border); }
    .task.completed-task { background: rgba(0,0,0,0.3); opacity: 0.6; }
    .task.task-overdue { border: 2px solid #ff4444; }
    .task-indicators { display: flex; align-items: center; gap: 12px; flex-shrink: 0; }
    .task.subtask { padding: 10px 14px; margin-left: 32px; position: relative; }
    .task.subtask::before { content: ''; position: absolute; left: -20px; top: 50%; width: 16px; height: 2px; background: var(--cubby-border); }
    .checkbox { width: 24px; height: 24px; min-width: 24px; border-radius: 6px; border: 2px solid var(--cubby-border); background: rgba(0,0,0,0.2); display: flex; align-items: center; justify-content: center; cursor: pointer; transition: all 0.2s ease; }
    .checkbox.small { width: 20px; height: 20px; min-width: 20px; }
    .checkbox.checked { background: var(--cubby-primary); border-color: var(--cubby-primary); box-shadow: 0 0 12px var(--cubby-glow); }
    .checkbox.pop { animation: checkPop 0.3s ease; }
    .checkbox svg { display: none; }
    .checkbox.checked svg { display: block; }
    .task-text { flex: 1; font-size: 16px; font-weight: 500; color: var(--cubby-text); transition: all 0.3s ease; }
    .task.subtask .task-text { font-size: 14px; }
    .task-text.completed { text-decoration: line-through; color: var(--cubby-text-muted); }
    .expand-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; border-radius: 6px; background: var(--cubby-card); cursor: pointer; transition: transform 0.2s ease; }
    .expand-btn.expanded { transform: rotate(90deg); }
    .expand-btn svg { color: var(--cubby-text); }
    .more-btn { width: 28px; height: 28px; display: flex; align-items: center; justify-content: center; cursor: pointer; }
    .more-btn svg { color: var(--cubby-text-muted); }
    .subtasks-container { position: relative; margin-left: 12px; display: none; }
    .subtasks-container.visible { display: block; }
    .subtasks-container::before { content: ''; position: absolute; left: 8px; top: 0; bottom: 8px; width: 2px; background: var(--cubby-border); border-radius: 1px; }
    .add-task-btn { display: flex; align-items: center; gap: 12px; padding: 12px 16px; background: transparent; border-radius: 12px; border: 1px dashed var(--cubby-border); cursor: pointer; }
    .add-task-btn .plus { color: var(--cubby-primary); font-size: 18px; font-weight: 600; }
    .add-task-btn .text { color: var(--cubby-text-muted); font-size: 14px; font-weight: 500; }
    
    /* Modal styles */
    .modal { position: fixed; top: 0; left: 0; width: 100%; height: 100%; display: none; z-index: 1000; }
    .modal#search-modal { height: calc(100% - var(--nav-height)); }
    .modal.active { display: block; }
    .modal-backdrop { position: absolute; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.7); backdrop-filter: blur(4px); }
    .modal-content { position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); background: #1a1a24; border-radius: 20px; padding: 24px; width: calc(100% - 40px); max-width: 400px; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 20px 60px rgba(0,0,0,0.5); max-height: calc(100vh - 80px); overflow-y: auto; }
    .modal-content h2 { font-size: 20px; font-weight: 700; color: #fff; margin-bottom: 16px; }
    .modal-content input { width: 100%; padding: 14px 16px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 12px; color: #fff; font-size: 16px; font-family: inherit; outline: none; transition: border-color 0.2s ease; }
    .modal-content input:focus { border-color: rgba(255,255,255,0.3); }
    .modal-content input::placeholder { color: rgba(255,255,255,0.3); }
    .modal-buttons { display: flex; gap: 12px; margin-top: 20px; }
    .modal-btn { flex: 1; padding: 14px; border-radius: 12px; font-size: 16px; font-weight: 600; font-family: inherit; cursor: pointer; transition: all 0.2s ease; }
    .modal-btn.cancel { background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); color: rgba(255,255,255,0.6); }
    .modal-btn.cancel:active { background: rgba(255,255,255,0.1); }
    .modal-btn.confirm { background: #5B8EFF; border: none; color: #fff; }
    .modal-btn.confirm:active { background: #4a7de8; }
    .modal-btn.delete-confirm { background: #ff4444; }
    .modal-btn.delete-confirm:active { background: #cc3333; }
    .confirm-message { font-size: 14px; color: rgba(255,255,255,0.6); margin-bottom: 20px; line-height: 1.5; }
    .confirm-dialog-content { max-width: 340px; }
    
    /* Add subtask button */
    .add-subtask-btn { display: flex; align-items: center; gap: 8px; padding: 8px 12px; margin-left: 32px; margin-top: 4px; margin-bottom: 12px; background: transparent; border-radius: 8px; border: 1px dashed var(--cubby-border); cursor: pointer; opacity: 0.7; transition: opacity 0.2s ease; }
    .add-subtask-btn:hover { opacity: 1; }
    .add-subtask-btn .plus { color: var(--cubby-primary); font-size: 14px; font-weight: 600; }
    .add-subtask-btn .text { color: var(--cubby-text-muted); font-size: 12px; font-weight: 500; }
    
    /* Kebab menu */
    .task-menu { position: fixed; background: #1a1a24; border-radius: 12px; border: 1px solid rgba(255,255,255,0.1); box-shadow: 0 10px 40px rgba(0,0,0,0.5); z-index: 100; min-width: 160px; overflow: hidden; display: none; }
    .task-menu.active { display: block; }
    .task-menu-item { display: flex; align-items: center; gap: 10px; padding: 12px 16px; font-size: 14px; font-weight: 500; color: rgba(255,255,255,0.8); cursor: pointer; transition: background 0.15s ease; }
    .task-menu-item:hover { background: rgba(255,255,255,0.05); }
    .task-menu-item svg { width: 16px; height: 16px; opacity: 0.6; }
    .task-menu-item.delete { color: #ff6b6b; }
    .task-menu-item.delete:hover { background: rgba(255,107,107,0.1); }
    .task-menu-item.delete svg { color: #ff6b6b; opacity: 0.8; }
    .task-menu-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99; }
    
    /* Move modal */
    .move-modal-content { max-height: 70vh; display: flex; flex-direction: column; }
    .move-options { flex: 1; overflow-y: auto; margin: 0 -24px; padding: 0 24px; max-height: 300px; }
    .move-option { padding: 12px 16px; margin-bottom: 8px; background: rgba(255,255,255,0.03); border-radius: 10px; cursor: pointer; transition: background 0.15s ease; }
    .move-option:hover { background: rgba(255,255,255,0.08); }
    .move-path { display: block; font-size: 12px; color: rgba(255,255,255,0.4); margin-bottom: 2px; }
    .move-subcubby { display: block; font-size: 15px; font-weight: 600; color: rgba(255,255,255,0.9); }
    
    /* Subcubby header layout */
    .subcubby-header { display: flex; align-items: center; justify-content: space-between; }
    .subcubby-header-left { display: flex; align-items: center; gap: 8px; flex: 1; cursor: pointer; }
    .subcubby-more-btn { padding: 8px; cursor: pointer; opacity: 0.5; transition: opacity 0.2s ease; }
    .subcubby-more-btn:hover { opacity: 1; }
    .subcubby-menu-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99; }
    
    /* Add subcubby button */
    .add-subcubby-btn { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 16px; margin-top: 16px; background: rgba(255,255,255,0.03); border-radius: 12px; border: 1px dashed var(--cubby-border); cursor: pointer; opacity: 0.6; transition: all 0.2s ease; }
    .add-subcubby-btn:hover { opacity: 1; background: rgba(255,255,255,0.05); }
    .add-subcubby-btn .plus { color: var(--cubby-primary); font-size: 16px; font-weight: 600; }
    .add-subcubby-btn .text { color: var(--cubby-text-muted); font-size: 14px; font-weight: 500; }
    
    /* Cubby card layout */
    .cubby-card { display: flex; align-items: center; position: relative; }
    .cubby-card-main { display: flex; align-items: center; justify-content: space-between; flex: 1; padding: 20px 24px; cursor: pointer; }
    .cubby-more-btn { padding: 20px 16px; cursor: pointer; opacity: 0.5; transition: opacity 0.2s ease; }
    .cubby-more-btn:hover { opacity: 1; }
    .cubby-menu-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99; }
    .cubby-date-toggle { padding: 10px; background: var(--cubby-card); border-radius: 12px; border: 1px solid var(--cubby-border); cursor: pointer; color: var(--cubby-text-muted); display: flex; align-items: center; justify-content: center; transition: all 0.2s ease; font-family: inherit; }
    .cubby-date-toggle:hover { background: var(--cubby-card-hover); color: var(--cubby-text); }
    .cubby-date-toggle:active { transform: scale(0.9); }
    .cubby-date-toggle.active { background: rgba(254,202,87,0.15); border-color: rgba(254,202,87,0.4); color: #feca57; }
    .cubby-settings-menu-backdrop { position: fixed; top: 0; left: 0; width: 100%; height: 100%; z-index: 99; }
    
    /* Add cubby button */
    .add-cubby-btn { display: flex; align-items: center; justify-content: center; gap: 8px; padding: 20px; margin-top: 12px; background: rgba(255,255,255,0.03); border-radius: 16px; border: 1px dashed rgba(255,255,255,0.15); cursor: pointer; opacity: 0.6; transition: all 0.2s ease; }
    .add-cubby-btn:hover { opacity: 1; background: rgba(255,255,255,0.05); }
    .add-cubby-btn .plus { color: rgba(255,255,255,0.6); font-size: 18px; font-weight: 600; }
    .add-cubby-btn .text { color: rgba(255,255,255,0.4); font-size: 15px; font-weight: 500; }
    
    /* Color picker modal (legacy - kept for compatibility) */
    .color-options { display: flex; gap: 8px; justify-content: space-between; margin: 16px 0; }
    
    /* Task layout */
    .task { display: flex; align-items: center; }
    .subcubby-header { display: flex; align-items: center; }
    
    /* Due date styles */
    .task-due-date { font-size: 11px; font-weight: 600; padding: 3px 0; border-radius: 6px; white-space: nowrap; width: 64px; min-width: 64px; text-align: center; flex-shrink: 0; }
    .task-due-date.overdue { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }
    .task-due-date.today, .task-due-date.due-today { background: rgba(254, 202, 87, 0.2); color: #feca57; }
    .task-due-date.tomorrow { background: rgba(46, 213, 115, 0.2); color: #2ed573; }
    .task-due-date.upcoming, .task-due-date.due-soon { background: rgba(91, 142, 255, 0.2); color: #5B8EFF; }
    .task-due-date.next-week { background: rgba(165, 94, 234, 0.2); color: #a55eea; }
    .task-due-date.future, .task-due-date.due-later { background: rgba(255, 255, 255, 0.12); color: #ffffff; }
    .task-due-date.no-date { background: rgba(255, 255, 255, 0.04); }
    .task.completed-task .task-due-date { opacity: 0.5; }
    
    /* Tag styles */
    .task-tags { display: flex; flex-wrap: wrap; gap: 4px; flex-shrink: 0; }
    .task-tag { font-size: 10px; font-weight: 600; padding: 2px 8px; border-radius: 10px; white-space: nowrap; text-transform: lowercase; }
    .task-tag.tag-red { background: rgba(255, 107, 107, 0.25); color: #ff6b6b; }
    .task-tag.tag-orange { background: rgba(255, 159, 67, 0.25); color: #ff9f43; }
    .task-tag.tag-yellow { background: rgba(254, 202, 87, 0.25); color: #feca57; }
    .task-tag.tag-green { background: rgba(46, 213, 115, 0.25); color: #2ed573; }
    .task-tag.tag-blue { background: rgba(91, 142, 255, 0.25); color: #5B8EFF; }
    .task-tag.tag-purple { background: rgba(165, 94, 234, 0.25); color: #a55eea; }
    .task-tag.tag-pink { background: rgba(255, 107, 181, 0.25); color: #ff6bb5; }
    .task-tag.tag-gray { background: rgba(255, 255, 255, 0.15); color: rgba(255, 255, 255, 0.7); }
    .task.completed-task .task-tag { opacity: 0.5; }

    /* Tags input in modal */
    .tags-row { margin-top: 12px; }
    .tags-row label { display: block; font-size: 14px; color: rgba(255,255,255,0.6); font-weight: 500; margin-bottom: 8px; }
    .tags-input-container { display: flex; flex-wrap: wrap; gap: 6px; padding: 10px 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 10px; min-height: 44px; align-items: center; }
    .tags-input-container:focus-within { border-color: rgba(255,255,255,0.3); }
    .tags-input-container .tag-pill { display: flex; align-items: center; gap: 4px; font-size: 12px; font-weight: 600; padding: 4px 8px; border-radius: 8px; cursor: default; }
    .tags-input-container .tag-pill .remove-tag { cursor: pointer; opacity: 0.6; font-size: 14px; line-height: 1; margin-left: 2px; }
    .tags-input-container .tag-pill .remove-tag:hover { opacity: 1; }
    .tags-input-container input { flex: 1; min-width: 80px; background: transparent; border: none; color: #fff; font-size: 14px; font-family: inherit; outline: none; padding: 4px 0; }
    .tags-input-container input::placeholder { color: rgba(255,255,255,0.3); }
    
    /* Tag color picker */
    .tag-colors { display: flex; gap: 6px; margin-top: 8px; }
    .tag-color-btn { width: 24px; height: 24px; border-radius: 50%; cursor: pointer; border: 2px solid transparent; transition: transform 0.15s ease, border-color 0.15s ease; }
    .tag-color-btn:hover { transform: scale(1.1); }
    .tag-color-btn.selected { border-color: rgba(255,255,255,0.8); }
    
    /* Date input in modal */
    .modal-content .date-row { display: flex; align-items: center; gap: 12px; margin-top: 12px; }
    .modal-content .date-row label { font-size: 14px; color: rgba(255,255,255,0.6); font-weight: 500; white-space: nowrap; }
    .modal-content input[type="date"] { flex: 1; padding: 10px 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 10px; color: #fff; font-size: 14px; font-family: inherit; outline: none; transition: border-color 0.2s ease; }
    .modal-content input[type="date"]:focus { border-color: rgba(255,255,255,0.3); }
    .modal-content input[type="date"]::-webkit-calendar-picker-indicator { filter: invert(1); opacity: 0.6; cursor: pointer; }
    .clear-date-btn { padding: 8px 12px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.1); border-radius: 8px; color: rgba(255,255,255,0.5); font-size: 12px; font-weight: 500; cursor: pointer; transition: all 0.2s ease; }
    .clear-date-btn:hover { background: rgba(255,255,255,0.1); color: rgba(255,255,255,0.8); }

/* Cubby creation modal fields */
.cubby-description-row { margin-top: 12px; }
.cubby-description-row label { display: block; font-size: 14px; color: rgba(255,255,255,0.6); font-weight: 500; margin-bottom: 8px; }
.cubby-description-row textarea { width: 100%; padding: 12px 14px; background: rgba(255,255,255,0.05); border: 1px solid rgba(255,255,255,0.15); border-radius: 10px; color: #fff; font-size: 14px; font-family: inherit; outline: none; resize: vertical; min-height: 50px; transition: border-color 0.2s ease; }
.cubby-description-row textarea:focus { border-color: rgba(255,255,255,0.3); }
.cubby-description-row textarea::placeholder { color: rgba(255,255,255,0.3); }

.cubby-color-row { margin-top: 12px; }
.cubby-color-row label { display: block; font-size: 14px; color: rgba(255,255,255,0.6); font-weight: 500; margin-bottom: 8px; }
.cubby-color-options { display: flex; gap: 6px; justify-content: space-between; }
.cubby-color-swatch { display: flex; align-items: center; justify-content: center; position: relative; width: 32px; height: 32px; border-radius: 8px; border: 2px solid transparent; cursor: pointer; transition: all 0.15s ease; flex-shrink: 0; }
.cubby-color-swatch:hover { transform: scale(1.08); }
.cubby-color-swatch.selected { box-shadow: 0 0 0 2px rgba(255,255,255,0.4); }
.cubby-color-swatch .cubby-color-dot { width: 14px; height: 14px; border-radius: 50%; flex-shrink: 0; }
.cubby-color-swatch.none { position: relative; }
.cubby-color-swatch.none svg { position: absolute; }
.cubby-color-swatch.none .cubby-color-dot { opacity: 0.4; }

.cubby-room-row { margin-top: 12px; }
.cubby-room-row label { display: block; font-size: 14px; color: rgba(255,255,255,0.6); font-weight: 500; margin-bottom: 8px; }
.cubby-room-options { display: flex; flex-wrap: wrap; gap: 8px; }
.cubby-room-option { padding: 8px 16px; border-radius: 10px; border: 1px solid rgba(255,255,255,0.15); background: rgba(255,255,255,0.05); color: rgba(255,255,255,0.6); font-size: 14px; font-weight: 600; cursor: pointer; transition: all 0.15s ease; }
.cubby-room-option:hover { background: rgba(255,255,255,0.08); }
.cubby-room-option.selected { border-color: #C77DFF; color: #C77DFF; background: rgba(199, 125, 255, 0.1); }

/* ============================================ */
/* SEARCH STYLES */
/* ============================================ */

/* Search button on home screen */
.search-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    padding: 16px 20px;
    margin-bottom: 24px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 16px;
    cursor: pointer;
    font-family: inherit;
    font-size: 15px;
    color: rgba(255,255,255,0.4);
    font-weight: 500;
    transition: all 0.2s ease;
}
.search-btn:hover {
    background: rgba(255,255,255,0.05);
    border-color: rgba(255,255,255,0.12);
}
.search-btn svg {
    opacity: 0.5;
}
.search-btn span:first-of-type {
    flex: 1;
    text-align: left;
}
.search-shortcut {
    font-size: 12px;
    padding: 4px 8px;
    background: rgba(255,255,255,0.06);
    border-radius: 6px;
    color: rgba(255,255,255,0.3);
}

/* Search modal */
#search-modal .modal-backdrop {
    background: rgba(0,0,0,0.8);
    backdrop-filter: blur(8px);
}

.search-modal-content {
    position: fixed;
    top: 10%;
    left: 50%;
    transform: translateX(-50%);
    width: 90%;
    max-width: 560px;
    max-height: 75vh;
    background: #151518;
    border-radius: 20px;
    border: 1px solid rgba(255,255,255,0.1);
    display: flex;
    flex-direction: column;
    overflow: hidden;
    z-index: 101;
}

@keyframes searchSlideIn {
    from { opacity: 0; transform: translateX(-50%) translateY(-10px); }
    to { opacity: 1; transform: translateX(-50%) translateY(0); }
}

.search-modal-content {
    animation: searchSlideIn 0.2s ease;
}

.search-header {
    padding: 16px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
}

.search-input-wrapper {
    display: flex;
    align-items: center;
    gap: 12px;
    padding: 12px 16px;
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
}

.search-input-wrapper:focus-within {
    border-color: rgba(255,255,255,0.2);
    background: rgba(255,255,255,0.07);
}

.search-icon {
    opacity: 0.4;
    flex-shrink: 0;
}

#search-input {
    flex: 1;
    background: none;
    border: none;
    outline: none;
    color: #fff;
    font-size: 16px;
    font-family: inherit;
    font-weight: 500;
}

#search-input::placeholder {
    color: rgba(255,255,255,0.3);
}

.search-clear-btn {
    background: rgba(255,255,255,0.1);
    border: none;
    width: 24px;
    height: 24px;
    border-radius: 50%;
    color: rgba(255,255,255,0.5);
    font-size: 16px;
    cursor: pointer;
    display: flex;
    align-items: center;
    justify-content: center;
}

.search-clear-btn:hover {
    background: rgba(255,255,255,0.15);
}

/* Search filters */
.search-filters {
    display: flex;
    gap: 8px;
    padding: 12px 16px;
    border-bottom: 1px solid rgba(255,255,255,0.06);
    overflow-x: auto;
    flex-shrink: 0;
    -webkit-overflow-scrolling: touch;
}

.filter-btn {
    padding: 8px 14px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 20px;
    color: rgba(255,255,255,0.5);
    font-size: 13px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    white-space: nowrap;
    flex-shrink: 0;
    transition: all 0.2s ease;
}

.filter-btn:hover {
    background: rgba(255,255,255,0.08);
}

.filter-btn.active {
    border-color: currentColor;
}

/* Color-coded filter buttons */
.filter-btn[data-filter="all"] { color: rgba(255,255,255,0.5); }
.filter-btn[data-filter="all"].active { background: rgba(255,255,255,0.12); color: #fff; }

.filter-btn[data-filter="active"] { color: #5B8EFF; }
.filter-btn[data-filter="active"].active { background: rgba(91, 142, 255, 0.2); color: #5B8EFF; }

.filter-btn[data-filter="completed"] { color: #5AE890; }
.filter-btn[data-filter="completed"].active { background: rgba(90, 232, 144, 0.2); color: #5AE890; }

.filter-btn[data-filter="due-soon"] { color: #feca57; }
.filter-btn[data-filter="due-soon"].active { background: rgba(254, 202, 87, 0.2); color: #feca57; }

.filter-btn[data-filter="overdue"] { color: #ff6b6b; }
.filter-btn[data-filter="overdue"].active { background: rgba(255, 107, 107, 0.2); color: #ff6b6b; }

/* Search results */
.search-results {
    flex: 1;
    overflow-y: auto;
    padding: 8px;
}

.search-empty {
    padding: 40px 20px;
    text-align: center;
    color: rgba(255,255,255,0.3);
    font-size: 14px;
}

.search-group {
    margin-bottom: 16px;
}

.search-group-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 12px;
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 0.5px;
}

.search-group-count {
    background: currentColor;
    color: #151518;
    padding: 2px 8px;
    border-radius: 10px;
    font-size: 11px;
}

.search-result-item {
    display: flex;
    align-items: flex-start;
    gap: 12px;
    padding: 12px;
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.15s ease;
}

.search-result-item:hover {
    background: rgba(255,255,255,0.05);
}

.search-result-item.completed {
    opacity: 0.5;
}

.search-result-check {
    width: 18px;
    height: 18px;
    border-radius: 50%;
    border: 2px solid;
    flex-shrink: 0;
    margin-top: 2px;
    display: flex;
    align-items: center;
    justify-content: center;
}

.search-result-check.checked {
    border-color: transparent !important;
}

.search-result-content {
    flex: 1;
    min-width: 0;
}

.search-result-subtask-indicator {
    color: rgba(255,255,255,0.3);
    margin-right: 6px;
}

.search-result-text {
    font-size: 14px;
    font-weight: 500;
    color: #fff;
    word-break: break-word;
}

.search-result-item.completed .search-result-text {
    text-decoration: line-through;
    color: rgba(255,255,255,0.5);
}

.search-result-text mark {
    background: rgba(255, 200, 50, 0.3);
    color: inherit;
    border-radius: 2px;
    padding: 0 2px;
}

.search-result-meta {
    display: flex;
    flex-wrap: wrap;
    gap: 6px;
    margin-top: 6px;
}

.search-result-tag {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 6px;
}

.search-result-due {
    font-size: 11px;
    font-weight: 600;
    padding: 3px 8px;
    border-radius: 6px;
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.6);
}

.search-result-due.overdue {
    background: rgba(255, 90, 90, 0.2);
    color: #ff6b6b;
}

.search-result-due.due-today {
    background: rgba(255, 159, 67, 0.2);
    color: #ff9f43;
}

.search-result-due.due-soon {
    background: rgba(254, 202, 87, 0.2);
    color: #feca57;
}

.search-result-location {
    font-size: 11px;
    color: rgba(255,255,255,0.3);
    flex-shrink: 0;
    margin-top: 3px;
}

/* Search highlight animation */
@keyframes highlightPulse {
    0%, 100% { box-shadow: 0 0 0 0 transparent; }
    50% { box-shadow: 0 0 0 4px var(--cubby-glow, rgba(179, 102, 255, 0.4)); }
}

/* Header search button (Room & Cubby screens) */
.header-search-btn {
    padding: 10px;
    background: rgba(255,255,255,0.05);
    border-radius: 12px;
    border: 1px solid rgba(255,255,255,0.08);
    cursor: pointer;
    color: rgba(255,255,255,0.5);
    display: flex;
    align-items: center;
    justify-content: center;
    transition: all 0.2s ease;
}
.header-search-btn:hover {
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.7);
}
.cubby-header .header-search-btn {
    background: var(--cubby-card);
    border-color: var(--cubby-border);
    color: var(--cubby-text-muted);
}
.cubby-header .header-search-btn:hover {
    background: var(--cubby-card-hover);
    color: var(--cubby-text);
}

/* ============================================ */
/* CUSTOM SCROLLBAR STYLES */
/* ============================================ */

/* Webkit browsers (Chrome, Safari, Edge) */
::-webkit-scrollbar {
    width: 6px;
    height: 6px;
}

::-webkit-scrollbar-track {
    background: transparent;
}

::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.15);
    border-radius: 3px;
}

::-webkit-scrollbar-thumb:hover {
    background: rgba(255,255,255,0.25);
}

/* Cubby screen scrollbar - uses theme color */
#cubby-screen::-webkit-scrollbar-thumb,
#cubby-screen .tasks-container::-webkit-scrollbar-thumb {
    background: var(--cubby-primary, rgba(255,255,255,0.15));
}

/* Firefox scrollbar */
* {
    scrollbar-width: thin;
    scrollbar-color: rgba(255,255,255,0.15) transparent;
}

#cubby-screen,
#cubby-screen .tasks-container {
    scrollbar-color: var(--cubby-primary) transparent;
}

/* Add right padding to scrollable containers for scrollbar spacing */
#home-screen {
    padding-right: 28px;
}

#room-screen .cubbies-list {
    padding-right: 12px;
}

#cubby-screen .tasks-container {
    padding-right: 12px;
}

.search-results {
    padding-right: 12px;
}

/* ============================================ */
/* SUBTASK COUNTER STYLES */
/* ============================================ */

.subtask-counter {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 4px;
    width: 44px;
    min-width: 44px;
    padding: 4px 0;
    background: var(--cubby-card);
    border: 1px solid var(--cubby-border);
    border-radius: 12px;
    cursor: pointer;
    transition: all 0.2s ease;
    flex-shrink: 0;
}

.subtask-counter:hover {
    background: var(--cubby-card-hover);
}

.subtask-count {
    font-size: 12px;
    font-weight: 600;
    color: var(--cubby-text-muted);
}

.subtask-counter.all-complete {
    background: rgba(90, 232, 144, 0.15);
    border-color: rgba(90, 232, 144, 0.3);
}

.subtask-counter.all-complete .subtask-count {
    color: #5AE890;
}

/* Adjust task layout when has subtasks */
.task.has-subtasks {
    /* marker class */
}

/* ============================================ */
/* TASK PROGRESS BAR */
/* ============================================ */

.task-progress {
    width: 48px;
    height: 6px;
    background: rgba(255,255,255,0.08);
    border-radius: 3px;
    overflow: hidden;
    flex-shrink: 0;
}

.task-progress-fill {
    height: 100%;
    background: var(--cubby-primary);
    border-radius: 3px;
    transition: width 0.3s ease;
    opacity: 0.7;
}

.task-progress-fill.complete {
    background: #5AE890;
    opacity: 1;
}

/* ============================================ */
/* TASK MEMO STYLES */
/* ============================================ */

/* Memo indicator icon on task row */
.memo-indicator {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 20px;
    min-width: 20px;
    flex-shrink: 0;
    color: var(--cubby-text-muted);
    opacity: 0.5;
}

/* Memo display in expanded area */
.task-memo-display {
    padding: 10px 14px;
    margin-left: 24px;
    margin-bottom: 8px;
    font-size: 13px;
    color: var(--cubby-text-muted);
    line-height: 1.5;
    border-left: 2px solid var(--cubby-primary);
    background: rgba(255,255,255,0.02);
    border-radius: 0 8px 8px 0;
}

/* Memo textarea in modal */
.memo-row {
    margin-top: 12px;
}

.memo-row label {
    display: block;
    font-size: 14px;
    color: rgba(255,255,255,0.6);
    font-weight: 500;
    margin-bottom: 8px;
}

.memo-row textarea {
    width: 100%;
    padding: 12px 14px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.15);
    border-radius: 10px;
    color: #fff;
    font-size: 14px;
    font-family: inherit;
    outline: none;
    resize: vertical;
    min-height: 60px;
    transition: border-color 0.2s ease;
}

.memo-row textarea:focus {
    border-color: rgba(255,255,255,0.3);
}

.memo-row textarea::placeholder {
    color: rgba(255,255,255,0.3);
}

/* ============================================ */
/* BUTTON PRESS EFFECTS */
/* ============================================ */

/* Generic button press effect */
.back-btn:active,
.new-task-btn:active,
.header-search-btn:active,
.search-btn:active,
.add-task-btn:active,
.add-subtask-btn:active,
.add-room-btn:active,
.add-cubby-btn:active,
.add-subcubby-btn:active,
.filter-btn:active,
.modal-btn:active {
    transform: scale(0.96);
    transition: transform 0.1s ease;
}

/* Cubby card press */
.cubby-card:active {
    animation: clickPop 0.2s ease;
}

/* Room card press */
.room-card:active {
    animation: clickPop 0.2s ease;
}

/* Task press effect */
.task:active:not(.expanded) {
    transform: scale(0.99);
    transition: transform 0.1s ease;
}

/* Checkbox press */
.checkbox:active {
    transform: scale(0.9);
    transition: transform 0.1s ease;
}

/* Expand button press */
.expand-btn:active {
    transform: scale(0.85) rotate(90deg);
    transition: transform 0.1s ease;
}

.expand-btn:not(.expanded):active {
    transform: scale(0.85);
}

/* Subtask counter press */
.subtask-counter:active {
    transform: scale(0.95);
    transition: transform 0.1s ease;
}

/* More/kebab button press */
.more-btn:active,
.room-more-btn:active,
.cubby-more-btn:active,
.subcubby-more-btn:active {
    transform: scale(0.85);
    transition: transform 0.1s ease;
}

/* When any task is expanded, dim other elements */
.tasks-container.has-expanded-task .subcubby-header,
.tasks-container.has-expanded-task .task:not(.expanded):not(.subtask),
.tasks-container.has-expanded-task .add-task-btn,
.tasks-container.has-expanded-task .add-subcubby-btn {
    opacity: 0.2;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

/* Keep expanded task and its subtasks fully visible */
.tasks-container.has-expanded-task .task.expanded,
.tasks-container.has-expanded-task .task.expanded + .subtasks-container,
.tasks-container.has-expanded-task .task.expanded + .subtasks-container .task.subtask,
.tasks-container.has-expanded-task .task.expanded + .subtasks-container .add-subtask-btn {
    opacity: 1;
    pointer-events: auto;
}

/* Expanded task with subtasks - just a nice border, no glow for now */
.task.expanded.has-subtasks {
    border-color: var(--cubby-primary);
}

/* When a task is highlighted from search/views navigation, dim other elements */
.tasks-container.has-highlighted-task .subcubby-header,
.tasks-container.has-highlighted-task .task:not(.highlight-target):not(.subtask),
.tasks-container.has-highlighted-task .add-task-btn,
.tasks-container.has-highlighted-task .add-subcubby-btn {
    opacity: 0.2;
    pointer-events: none;
    transition: opacity 0.3s ease;
}

/* Keep highlighted task and its subtasks fully visible */
.tasks-container.has-highlighted-task .task.highlight-target,
.tasks-container.has-highlighted-task .task.highlight-target + .subtasks-container,
.tasks-container.has-highlighted-task .task.highlight-target + .subtasks-container .task.subtask,
.tasks-container.has-highlighted-task .task.highlight-target + .subtasks-container .add-subtask-btn {
    opacity: 1;
    pointer-events: auto;
}

/* Search highlight - ensure border/glow isn't clipped */
.search-highlight {
    animation: highlightPulse 0.5s ease 3;
    background: var(--cubby-card-hover) !important;
    z-index: 2;
    position: relative;
}

/* Subtasks container */
.subtasks-container {
    position: relative;
    margin-left: 32px;
}

/* Vertical line on the left */
.subtasks-container::before {
    content: '';
    position: absolute;
    left: 0;
    top: 0;
    bottom: 17px;
    width: 2px;
    background: var(--cubby-border);
}

/* Hide vertical line when there are no subtasks (only add button) */
.subtasks-container:not(:has(.task.subtask))::before {
    display: none;
}

/* Subtask styling */
.task.subtask {
    position: relative;
    margin-left: 24px;
}

/* Horizontal connector from vertical line to subtask */
.task.subtask::before {
    content: '';
    position: absolute;
    left: -24px;
    top: 50%;
    width: 20px;
    height: 2px;
    background: var(--cubby-border);
}

/* Add subtask button */
.add-subtask-btn {
    position: relative;
    margin-left: 24px;
}

/* Curved connector for add subtask button */
.add-subtask-btn::before {
    content: '';
    position: absolute;
    left: -24px;
    top: 50%;
    width: 20px;
    height: 2px;
    background: var(--cubby-border);
}

/* When no subtasks, don't show the curve either */
.subtasks-container:not(:has(.task.subtask)) .add-subtask-btn::before {
    display: none;
}

/* ============================================ */
/* BUTTON PRESS STATES (Mobile-friendly) */
/* ============================================ */

/* Tasks */
.task:active {
    transform: scale(0.99);
    filter: brightness(1.15);
}

/* Checkboxes */
.checkbox:active {
    transform: scale(0.9);
}

/* Back button */
.back-btn:active {
    transform: scale(0.95);
    filter: brightness(1.2);
}

/* New task button */
.new-task-btn:active {
    transform: scale(0.95);
    filter: brightness(1.2);
}

/* Search button */
.search-btn:active {
    transform: scale(0.98);
    background: rgba(255,255,255,0.08);
}

.header-search-btn:active {
    transform: scale(0.9);
    filter: brightness(1.2);
}

/* Add buttons (new task, new subtask, new subcubby, new room, new cubby) */
.add-task-btn:active,
.add-subtask-btn:active,
.add-subcubby-btn:active,
.add-room-btn:active,
.add-cubby-btn:active {
    transform: scale(0.98);
    filter: brightness(1.2);
}

/* Expand button */
.expand-btn:active {
    transform: scale(0.85) rotate(90deg);
}

.expand-btn:not(.expanded):active {
    transform: scale(0.85);
}

/* More/kebab menu button */
.more-btn:active {
    transform: scale(0.85);
    opacity: 1;
}

/* Subcubby header */
.subcubby-header:active {
    opacity: 0.8;
}

/* Modal buttons */
.modal-btn:active {
    transform: scale(0.97);
    filter: brightness(1.1);
}

/* Filter buttons in search */
.filter-btn:active {
    transform: scale(0.95);
    filter: brightness(1.2);
}

/* Subtask counter */
.subtask-counter:active {
    transform: scale(0.95);
    filter: brightness(1.2);
}

/* Menu items */
.task-menu-item:active {
    background: rgba(255,255,255,0.1);
}

.task-menu-item.delete:active {
    background: rgba(255,107,107,0.2);
}

/* ============================================ */
/* VERSION NUMBER */
/* ============================================ */

.logo {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
}

.version {
    font-size: 10px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.25);
    letter-spacing: 0.5px;
}

/* ============================================ */
/* AUTH SCREEN STYLES */
/* ============================================ */

#auth-screen {
    background: #0a0a0f;
    justify-content: center;
    align-items: center;
    padding: 20px;
}

.auth-container {
    width: 100%;
    max-width: 360px;
    animation: slideIn 0.4s ease;
}

.auth-logo {
    font-size: 24px;
    font-weight: 800;
    letter-spacing: 3px;
    color: rgba(255, 255, 255, 0.15);
    text-align: center;
    margin-bottom: 40px;
}

.auth-title {
    font-size: 28px;
    font-weight: 700;
    color: #fff;
    margin-bottom: 32px;
    text-align: center;
}

#auth-form {
    display: flex;
    flex-direction: column;
    gap: 16px;
}

.auth-input-group input {
    width: 100%;
    padding: 16px 20px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 14px;
    color: #fff;
    font-size: 16px;
    font-family: inherit;
    font-weight: 500;
    outline: none;
    transition: all 0.2s ease;
}

.auth-input-group input:focus {
    border-color: rgba(255, 255, 255, 0.25);
    background: rgba(255, 255, 255, 0.08);
}

.auth-input-group input::placeholder {
    color: rgba(255, 255, 255, 0.3);
}

.auth-error {
    color: #ff6b6b;
    font-size: 14px;
    font-weight: 500;
    text-align: center;
    min-height: 20px;
}

.auth-btn {
    width: 100%;
    padding: 16px;
    background: #C77DFF;
    border: none;
    border-radius: 14px;
    color: #fff;
    font-size: 16px;
    font-weight: 700;
    font-family: inherit;
    cursor: pointer;
    transition: all 0.2s ease;
    margin-top: 8px;
}

.auth-btn:hover {
    background: #b366e8;
}

.auth-btn:active {
    transform: scale(0.98);
}

.auth-btn:disabled {
    opacity: 0.6;
    cursor: not-allowed;
}

.auth-switch {
    text-align: center;
    margin-top: 32px;
    color: rgba(255, 255, 255, 0.5);
    font-size: 14px;
    font-weight: 500;
}

.auth-switch-btn {
    background: none;
    border: none;
    color: #C77DFF;
    font-size: 14px;
    font-weight: 600;
    font-family: inherit;
    cursor: pointer;
    margin-left: 4px;
}

.auth-switch-btn:hover {
    text-decoration: underline;
}

/* ============================================ */
/* DRAG & DROP STYLES */
/* ============================================ */

/* Element being dragged (original position placeholder) */
.dragging {
    opacity: 0 !important;
    pointer-events: none;
}

/* Drag clone (the element you see moving  frosted glass, highlighted) */
.drag-clone {
    opacity: 1 !important;
    transform: scale(1.03) !important;
    box-shadow: 0 20px 40px rgba(0, 0, 0, 0.5), 0 0 0 1px rgba(255, 255, 255, 0.15) !important;
    cursor: grabbing !important;
    will-change: transform, top;
    backdrop-filter: blur(14px) saturate(1.3);
    -webkit-backdrop-filter: blur(14px) saturate(1.3);
    filter: brightness(1.15) saturate(1.1);
}

/* Keep clone card styling visible (highlighted, not muted) */
.drag-clone.task,
.drag-clone.subtask {
    background: var(--cubby-card-hover) !important;
    border-color: var(--cubby-border) !important;
}

.drag-clone .subcubby-tasks {
    display: none !important;
}

/* Container during drag  disable hover effects */
.drag-active .room-card,
.drag-active .cubby-card,
.drag-active .subcubby,
.drag-active .task {
    transition: transform 0.25s cubic-bezier(0.2, 0, 0, 1);
    pointer-events: none;
}

/* Preparing to drag */
.drag-preparing {
    cursor: grabbing;
}

/* Make draggable elements have a grab cursor on hover */
.room-card-main,
.cubby-card-main {
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
}

.subcubby-header,
.subcubby-header-left {
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
}

.task:not(.subtask),
.task.subtask {
    cursor: grab;
    user-select: none;
    -webkit-user-select: none;
}

.room-card-main:active,
.cubby-card-main:active,
.subcubby-header:active,
.subcubby-header-left:active,
.task:active {
    cursor: grabbing;
}

/* Smooth transitions for reordering */
.drag-active .room-card:not(.dragging),
.drag-active .cubby-card:not(.dragging),
.drag-active .subcubby:not(.dragging),
.drag-active .task:not(.dragging) {
    transition: transform 0.25s cubic-bezier(0.2, 0, 0, 1);
}

/* Touch feedback */
@media (hover: none) and (pointer: coarse) {
    .drag-clone {
        transform: scale(1.08) !important;
    }
}

/* Home section drag styles */
.home-section-wrapper.dragging,
.home-widget-grid.dragging {
    opacity: 0 !important;
    pointer-events: none;
}

.drag-clone.home-section-wrapper,
.drag-clone.home-widget-grid {
    border: 2px dashed rgba(107, 163, 255, 0.4) !important;
    background: rgba(107, 163, 255, 0.08) !important;
    border-radius: 16px !important;
}

#home-sections-container.drag-active > .home-section-wrapper:not(.dragging),
#home-sections-container.drag-active > .home-widget-grid:not(.dragging) {
    transition: transform 0.25s cubic-bezier(0.2, 0, 0, 1);
}

/* ============================================ */
/* VIEWS STYLES */
/* ============================================ */

/* Views button on home screen */
.views-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    padding: 16px 20px;
    margin-bottom: 24px;
    background: rgba(255,255,255,0.03);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 16px;
    cursor: pointer;
    font-family: inherit;
    font-size: 15px;
    color: rgba(255,255,255,0.6);
    font-weight: 600;
    transition: all 0.2s ease;
}
.views-btn:hover {
    background: rgba(255,255,255,0.05);
    border-color: rgba(255,255,255,0.12);
}
.views-btn:active {
    transform: scale(0.98);
}
.views-btn svg {
    opacity: 0.5;
}
.views-subtitle {
    font-size: 12px;
    font-weight: 500;
    color: rgba(255,255,255,0.3);
    margin-left: auto;
}

/* Views screen */
#views-screen {
    padding: calc(var(--safe-top) + 12px) 16px var(--nav-height);
    background: #0a0a0f;
    overflow: hidden;
}
.views-title {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
}
.views-title h1 {
    font-size: 32px;
    font-weight: 800;
}
.views-container {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 40px;
    padding-right: 12px;
}

/* View controls row (filters + color toggle) */
.view-controls {
    display: flex;
    align-items: flex-start;
    gap: 10px;
    margin-bottom: 20px;
}
.view-controls .view-filters {
    flex: 1;
    margin-bottom: 0;
}

/* View color mode toggle (in header) */
.view-mode-toggle {
    display: flex;
    gap: 6px;
}
.view-mode-btn {
    padding: 8px 12px;
    border-radius: 10px;
    border: 2px solid rgba(255,255,255,0.1);
    background: rgba(255,255,255,0.03);
    color: rgba(255,255,255,0.35);
    font-family: inherit;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: color 0.15s ease, border-color 0.15s ease, background 0.15s ease;
    -webkit-tap-highlight-color: transparent;
    white-space: nowrap;
}
.view-mode-btn.active {
    color: #feca57;
    border-color: rgba(254,202,87,0.4);
    background: rgba(254,202,87,0.1);
}

/* View filter buttons */
.view-filters {
    display: flex;
    flex-wrap: wrap;
    gap: 8px;
    margin-bottom: 20px;
}
.view-filter-btn {
    flex: 1;
    min-width: 0;
    padding: 8px 4px;
    border-radius: 12px;
    border: 2px solid rgba(255,255,255,0.15);
    background: none;
    color: rgba(255,255,255,0.5);
    font-family: inherit;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
    -webkit-tap-highlight-color: transparent;
    text-align: center;
}
.view-filter-btn:active {
    transform: scale(0.95);
}
.view-filter-btn.active {
    color: var(--filter-color, #fff);
    border-color: var(--filter-color, rgba(255,255,255,0.4));
    background: rgba(255,255,255,0.08);
}

/* Views empty state */
.views-empty {
    padding: 60px 20px;
    text-align: center;
    color: rgba(255,255,255,0.3);
    font-size: 15px;
    font-weight: 500;
}

/* View group */
.view-group {
    margin-bottom: 20px;
}
.view-group-header {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 8px 4px;
    cursor: pointer;
    user-select: none;
    -webkit-user-select: none;
}
.view-group-header:active {
    opacity: 0.8;
}
.view-group-chevron {
    transition: transform 0.2s ease;
    transform: rotate(90deg);
    flex-shrink: 0;
}
.view-group.collapsed .view-group-chevron {
    transform: rotate(0deg);
}
.view-group-label {
    font-size: 14px;
    font-weight: 700;
    letter-spacing: 0.5px;
}
.view-group-count {
    font-size: 11px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 10px;
    color: #0a0a0f;
}

/* View task card (cubby-style) */
.view-task-card {
    margin-bottom: 6px;
}
.view-task-card .task {
    background: var(--cubby-card);
    border: 2px solid var(--cubby-border);
    border-radius: 14px;
    padding: 14px;
    display: flex;
    align-items: center;
    gap: 12px;
    position: relative;
    transition: all 0.15s ease;
    cursor: pointer;
}
.view-task-card .task.task-overdue {
    border: 2px solid #ff4444;
}
.view-task-card .task:active {
    transform: scale(0.99);
}
.view-task-card .checkbox {
    width: 28px;
    height: 28px;
    min-width: 28px;
    border-radius: 6px;
    border: 2px solid var(--cubby-primary);
    display: flex;
    align-items: center;
    justify-content: center;
    cursor: pointer;
    flex-shrink: 0;
    transition: all 0.2s ease;
}
.view-task-card .checkbox.checked {
    background: var(--cubby-primary);
    border-color: var(--cubby-primary);
}
.view-task-card .checkbox.pop {
    animation: checkPop 0.3s ease;
}
.view-task-card .checkbox svg {
    opacity: 0;
}
.view-task-card .checkbox.checked svg {
    opacity: 1;
}
.view-task-card .task-text {
    font-size: 14px;
    font-weight: 500;
    color: var(--cubby-text);
    word-break: break-word;
    min-width: 0;
    line-height: 1.1;
}
.view-task-card .task-text.completed {
    text-decoration: line-through;
    opacity: 0.4;
}
.view-task-card .task-progress {
    width: 40px;
    height: 3px;
    background: rgba(255,255,255,0.1);
    border-radius: 2px;
    overflow: hidden;
    flex-shrink: 0;
}
.view-task-card .task-progress-fill {
    height: 100%;
    background: var(--cubby-primary);
    border-radius: 2px;
    transition: width 0.3s ease;
}
.view-task-card .subtask-counter {
    font-size: 11px;
    color: var(--cubby-text-muted);
    flex-shrink: 0;
    padding: 0;
    border: none;
    background: none;
}
.view-task-card .memo-indicator {
    color: var(--cubby-text-muted);
    flex-shrink: 0;
    display: flex;
    align-items: center;
}

/* View task text group (cubby name + task name stacked) */
.view-task-text-group {
    flex: 1;
    min-width: 0;
    display: flex;
    flex-direction: column;
    justify-content: center;
    gap: 3px;
}
.view-task-location {
    font-size: 9px;
    font-weight: 600;
    text-transform: none;
    letter-spacing: 0.5px;
    opacity: 0.7;
    line-height: 1.1;
}

/* ============================================ */
/* BOTTOM NAVIGATION BAR */
/* ============================================ */

.bottom-nav {
    position: fixed;
    bottom: 0;
    left: 0;
    right: 0;
    z-index: 50;
    display: flex;
    align-items: flex-start;
    gap: 6px;
    padding: 8px 8px;
    padding-bottom: calc(8px + env(safe-area-inset-bottom, 20px));
    background: rgba(10, 10, 15, 0.85);
    backdrop-filter: blur(20px);
    -webkit-backdrop-filter: blur(20px);
    border-top: 1px solid rgba(255, 255, 255, 0.06);
}

.nav-tab {
    display: flex;
    flex-direction: column;
    align-items: center;
    justify-content: center;
    gap: 2px;
    flex: 1;
    min-width: 0;
    height: 50px;
    padding: 4px 0;
    background: none;
    border: 2px solid rgba(255, 255, 255, 0.1);
    border-radius: 12px;
    color: rgba(255, 255, 255, 0.35);
    font-family: inherit;
    font-size: 10px;
    font-weight: 600;
    cursor: pointer;
    transition: color 0.2s ease, border-color 0.2s ease, background 0.2s ease;
    -webkit-tap-highlight-color: transparent;
}

.nav-tab svg {
    transition: color 0.2s ease;
}

/* Per-tab active colors */
.nav-tab-home.active {
    color: #6BA3FF;
    border-color: rgba(107, 163, 255, 0.4);
    background: rgba(107, 163, 255, 0.08);
}

.nav-tab-views.active {
    color: #5AF0E0;
    border-color: rgba(90, 240, 224, 0.4);
    background: rgba(90, 240, 224, 0.08);
}

.nav-tab-search.active {
    color: #C77DFF;
    border-color: rgba(199, 125, 255, 0.4);
    background: rgba(199, 125, 255, 0.08);
}

.nav-tab-profile.active {
    color: #FF6BAD;
    border-color: rgba(255, 107, 173, 0.4);
    background: rgba(255, 107, 173, 0.08);
}

.nav-tab-cubbies.active {
    color: #FFB05A;
    border-color: rgba(255, 176, 90, 0.4);
    background: rgba(255, 176, 90, 0.08);
}

.nav-tab-notebooks.active {
    color: #FFE85A;
    border-color: rgba(255, 232, 90, 0.4);
    background: rgba(255, 232, 90, 0.08);
}

.nav-tab:active {
    transform: scale(0.92);
    filter: brightness(0.6);
    transition: transform 0.06s ease, filter 0.06s ease;
}

/* Per-tab click darken (darker version of that button's color) */
.nav-tab-home.active:active { background: rgba(107, 163, 255, 0.15); }
.nav-tab-views.active:active { background: rgba(90, 240, 224, 0.15); }
.nav-tab-search.active:active { background: rgba(199, 125, 255, 0.15); }
.nav-tab-profile.active:active { background: rgba(255, 107, 173, 0.15); }
.nav-tab-cubbies.active:active { background: rgba(255, 176, 90, 0.15); }
.nav-tab-notebooks.active:active { background: rgba(255, 232, 90, 0.15); }
.nav-tab-add:active { background: rgba(107, 245, 160, 0.15); }

/* Nav tab hover - visible lift (inactive tabs only) */
.nav-tab:not(.active):hover {
    color: rgba(255, 255, 255, 0.6);
    border-color: rgba(255, 255, 255, 0.2);
    background: rgba(255, 255, 255, 0.05);
    transition: all 0.06s ease;
}

/* Active tab hover - brighter version of the selected color */
.nav-tab.active:hover {
    filter: brightness(1.25) saturate(1.3);
    transition: filter 0.06s ease;
}
.nav-tab-add:not(.active):hover {
    color: #6BF5A0;
    border-color: rgba(107, 245, 160, 0.3);
    background: rgba(107, 245, 160, 0.06);
    filter: brightness(1.2) saturate(1.2);
    transition: all 0.06s ease;
}

/* Task card hover */
.task:hover:not(.expanded):not(.subtask) {
    background: var(--cubby-card-hover);
    border-color: var(--cubby-border);
    transition: all 0.06s ease;
}
.task.subtask:hover {
    background: var(--cubby-card-hover);
    transition: all 0.06s ease;
}

/* The + New button (slightly lighter grey default, green on hover/active) */
.nav-tab-add {
    flex: 1.4;
    color: rgba(255, 255, 255, 0.45);
    border-color: rgba(255, 255, 255, 0.15);
    background: rgba(255, 255, 255, 0.03);
}

.nav-tab-add.active {
    color: #6BF5A0;
    border-color: rgba(107, 245, 160, 0.4);
    background: rgba(107, 245, 160, 0.08);
}

/* ============================================ */
/* APP SIDEBAR */
/* ============================================ */

.app-sidebar {
    position: fixed;
    top: 0;
    left: 0;
    bottom: 0;
    width: 260px;
    background: #0d0d14;
    border-right: 1px solid rgba(255,255,255,0.06);
    z-index: 100;
    display: flex;
    flex-direction: column;
    overflow: hidden;
    transition: transform 0.3s cubic-bezier(0.4, 0, 0.2, 1);
}

.sidebar-header {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 16px 16px 8px;
}

.sidebar-logo {
    font-size: 18px;
    font-weight: 800;
    color: #fff;
    letter-spacing: 2px;
}

.sidebar-close-btn {
    display: none; /* shown on mobile only */
    padding: 8px;
    background: rgba(255,255,255,0.05);
    border: 1px solid rgba(255,255,255,0.08);
    border-radius: 10px;
    color: rgba(255,255,255,0.4);
    cursor: pointer;
    transition: all 0.2s ease;
}
.sidebar-close-btn:hover {
    background: rgba(255,255,255,0.08);
    color: rgba(255,255,255,0.6);
}

.sidebar-nav {
    display: flex;
    flex-direction: column;
    gap: 1px;
    padding: 6px 10px;
}

.sidebar-nav-item {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    background: none;
    border: none;
    border-radius: 8px;
    color: rgba(255,255,255,0.45);
    font-family: inherit;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
    width: 100%;
    text-align: left;
}
.sidebar-nav-item:hover {
    background: rgba(255,255,255,0.06);
    color: rgba(255,255,255,0.75);
}
.sidebar-nav-item:active {
    transform: scale(0.97);
    filter: brightness(0.7);
}
.sidebar-nav-item.active {
    background: rgba(107, 163, 255, 0.1);
    color: #6BA3FF;
}
.sidebar-nav-item.active svg {
    color: #6BA3FF;
    opacity: 1;
}
.sidebar-nav-item svg {
    flex-shrink: 0;
    opacity: 0.6;
    width: 18px;
    height: 18px;
}

.sidebar-divider {
    height: 1px;
    background: rgba(255,255,255,0.06);
    margin: 6px 14px;
}

.sidebar-section-label {
    display: flex;
    align-items: center;
    justify-content: space-between;
    font-size: 11px;
    font-weight: 700;
    color: rgba(255,255,255,0.25);
    letter-spacing: 0.8px;
    padding: 8px 16px 4px;
}

.sidebar-add-workspace-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    background: none;
    border: 1px solid rgba(255,255,255,0.1);
    border-radius: 6px;
    color: rgba(255,255,255,0.25);
    cursor: pointer;
    transition: all 0.15s ease;
    padding: 0;
}
.sidebar-add-workspace-btn:hover {
    background: rgba(255,255,255,0.06);
    color: rgba(255,255,255,0.5);
    border-color: rgba(255,255,255,0.2);
}
.sidebar-add-workspace-btn:active {
    transform: scale(0.9);
}

.sidebar-workspaces {
    flex: 1;
    overflow-y: auto;
    padding: 2px 10px;
    min-height: 0;
}

/* Scrollbar styling for sidebar */
.sidebar-workspaces::-webkit-scrollbar {
    width: 4px;
}
.sidebar-workspaces::-webkit-scrollbar-track {
    background: transparent;
}
.sidebar-workspaces::-webkit-scrollbar-thumb {
    background: rgba(255,255,255,0.1);
    border-radius: 2px;
}

.sidebar-workspace-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 6px 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s ease;
    margin-bottom: 1px;
    user-select: none;
}
.sidebar-workspace-item:hover {
    background: rgba(255,255,255,0.05);
}
.sidebar-workspace-item:active {
    transform: scale(0.98);
}
.sidebar-workspace-item.active {
    background: rgba(255,255,255,0.06);
}
.sidebar-workspace-chevron {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 16px;
    height: 16px;
    flex-shrink: 0;
    color: rgba(255,255,255,0.2);
    transition: transform 0.2s ease;
}
.sidebar-workspace-chevron.expanded {
    transform: rotate(90deg);
}
.sidebar-workspace-chevron svg {
    width: 12px;
    height: 12px;
}
.sidebar-workspace-dot {
    width: 8px;
    height: 8px;
    border-radius: 3px;
    flex-shrink: 0;
}
.sidebar-workspace-name {
    font-size: 13px;
    font-weight: 600;
    color: rgba(255,255,255,0.6);
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-transform: none;
}
.sidebar-workspace-count {
    font-size: 10px;
    font-weight: 600;
    color: rgba(255,255,255,0.15);
    min-width: 16px;
    text-align: center;
}

.sidebar-cubbies-list {
    overflow: hidden;
    transition: max-height 0.25s ease, opacity 0.2s ease;
    max-height: 0;
    opacity: 0;
}
.sidebar-cubbies-list.expanded {
    max-height: 500px;
    opacity: 1;
}

.sidebar-cubby-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 5px 10px 5px 36px;
    border-radius: 6px;
    cursor: pointer;
    transition: all 0.15s ease;
    margin-bottom: 0;
}
.sidebar-cubby-item:hover {
    background: rgba(255,255,255,0.04);
}
.sidebar-cubby-item.active {
    background: rgba(255,255,255,0.06);
}
.sidebar-cubby-dot {
    width: 6px;
    height: 6px;
    border-radius: 50%;
    flex-shrink: 0;
}
.sidebar-cubby-name {
    font-size: 12px;
    font-weight: 500;
    color: rgba(255,255,255,0.4);
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-transform: none;
}
.sidebar-cubby-item.active .sidebar-cubby-name {
    color: rgba(255,255,255,0.7);
    font-weight: 600;
}
.sidebar-cubby-name,
.sidebar-workspace-name { text-transform: none; }

.sidebar-bottom {
    border-top: 1px solid rgba(255,255,255,0.06);
    padding: 6px 10px 10px;
    display: flex;
    flex-direction: column;
    gap: 2px;
}

.sidebar-new-btn {
    color: rgba(107, 245, 160, 0.7) !important;
}
.sidebar-new-btn:hover {
    color: #6BF5A0 !important;
    background: rgba(107, 245, 160, 0.08) !important;
}

/* User row at bottom of sidebar */
.sidebar-user-row {
    display: flex;
    align-items: center;
    gap: 10px;
    padding: 8px 10px;
    border-radius: 8px;
    cursor: pointer;
    transition: all 0.15s ease;
}
.sidebar-user-row:hover {
    background: rgba(255,255,255,0.05);
}
.sidebar-user-row:active {
    transform: scale(0.97);
}
.sidebar-user-avatar {
    width: 28px;
    height: 28px;
    border-radius: 50%;
    background: rgba(107, 163, 255, 0.2);
    color: #6BA3FF;
    display: flex;
    align-items: center;
    justify-content: center;
    font-size: 12px;
    font-weight: 700;
    flex-shrink: 0;
    text-transform: uppercase;
}
.sidebar-user-name {
    font-size: 13px;
    font-weight: 600;
    color: rgba(255,255,255,0.5);
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
    text-transform: none;
}
.sidebar-user-row svg {
    flex-shrink: 0;
    color: rgba(255,255,255,0.2);
    opacity: 0.6;
}

/* Sidebar overlay (mobile only) */
.sidebar-overlay {
    display: none;
    position: fixed;
    inset: 0;
    background: rgba(0,0,0,0.6);
    z-index: 99;
    opacity: 0;
    transition: opacity 0.3s ease;
}
.sidebar-overlay.active {
    display: block;
    opacity: 1;
}

/* ============================================ */
/* RESPONSIVE LAYOUT  DESKTOP (>768px) */
/* ============================================ */

@media (min-width: 769px) {
    /* Show sidebar, hide bottom nav */
    .app-sidebar {
        transform: translateX(0);
    }
    .bottom-nav {
        display: none !important;
    }
    .sidebar-close-btn {
        display: none;
    }
    .sidebar-overlay {
        display: none !important;
    }

    /* Shift all screens to the right of the sidebar (except auth) */
    .screen {
        left: 260px;
        width: calc(100% - 260px);
    }
    #auth-screen {
        left: 0;
        width: 100%;
    }

    /* Remove bottom nav padding from screens, add desktop padding */
    #home-screen {
        padding: calc(var(--safe-top) + 20px) 40px 40px;
    }
    #views-screen {
        padding: calc(var(--safe-top) + 12px) 40px 40px;
    }
    #cubbies-screen,
    #room-screen,
    #cubby-screen,
    #settings-screen,
    #archive-screen,
    #trash-screen {
        padding-left: 40px;
        padding-right: 40px;
        padding-bottom: 40px;
    }

    /* Center content within the work area (sidebar  browser edge) */
    #home-screen,
    #views-screen,
    #cubbies-screen,
    #room-screen,
    #cubby-screen,
    #settings-screen,
    #archive-screen,
    #trash-screen {
        align-items: center;
    }

    /* All top-level content blocks: max-width + centered */
    .home-header,
    .search-btn,
    .logo,
    .dashboard-section-label,
    #rooms-container {
        width: 100%;
        max-width: 900px;
    }

    #home-sections-container {
        width: 100%;
        max-width: 900px;
        display: flex;
        flex-direction: column;
        gap: 24px;
    }

    .header,
    .views-title,
    .views-container,
    #views-container {
        width: 100%;
        max-width: 900px;
    }

    .cubbies-browse-title,
    .cubbies-browse-container,
    #cubbies-browse-container {
        width: 100%;
        max-width: 800px;
    }

    .room-title,
    #room-title,
    .cubbies-list,
    #cubbies-list {
        width: 100%;
        max-width: 800px;
    }

    .cubby-header,
    .cubby-title,
    #cubby-title,
    .tasks-container,
    #tasks-container {
        width: 100%;
        max-width: 900px;
    }

    /* --- STAGE 3: Desktop Cubby View --- */

    /* Cubby header: sticky toolbar with bottom border */
    .cubby-header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: transparent;
        padding-bottom: 16px;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }

    /* Cubby name inline in header on desktop */
    .cubby-title {
        margin-bottom: 0;
        padding: 16px 0 20px;
    }
    .cubby-title h1 {
        font-size: 24px;
    }
    .cubby-description {
        font-size: 13px;
        margin-top: 4px;
    }

    /* Wider task rows on desktop */
    .task:not(.subtask) {
        padding: 16px 20px;
        gap: 16px;
    }

    /* Subcubby headers: accent left border, more weight */
    .subcubby {
        margin-bottom: 32px;
    }
    .subcubby-header {
        padding: 10px 16px;
        border-left: 3px solid var(--cubby-primary);
        border-radius: 0;
        margin-bottom: 16px;
    }
    .subcubby-header h3 {
        font-size: 15px;
    }

    /* Task indicators: more breathing room */
    .task-indicators {
        gap: 16px;
    }

    /* --- END STAGE 3 --- */

    /* --- STAGE 4: Desktop Tasks Page --- */

    /* Views header: sticky toolbar with bottom border */
    #views-screen > .header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: transparent;
        padding-bottom: 16px;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }

    /* Views title: smaller on desktop */
    .views-title {
        margin-bottom: 0;
        padding: 16px 0 12px;
    }
    .views-title h1 {
        font-size: 24px;
    }

    /* Filter tabs: clean horizontal toolbar */
    .view-controls {
        padding: 12px 0 8px;
    }
    .view-filters {
        flex-wrap: nowrap;
        gap: 6px;
    }
    .view-filter-btn {
        flex: 0 0 auto;
        min-width: auto;
        padding: 6px 16px;
        border-radius: 20px;
        font-size: 13px;
        border-width: 1px;
        border-color: rgba(255,255,255,0.08);
        background: rgba(255,255,255,0.03);
        transition: all 0.15s ease;
    }
    .view-filter-btn:hover {
        background: rgba(255,255,255,0.06);
        border-color: rgba(255,255,255,0.12);
    }
    .view-filter-btn.active {
        border-width: 1px;
        background: color-mix(in srgb, var(--filter-color, #fff) 12%, transparent);
        border-color: color-mix(in srgb, var(--filter-color, #fff) 35%, transparent);
    }

    /* Color mode toggle: refined segmented control */
    .view-mode-toggle {
        gap: 4px;
        background: rgba(255,255,255,0.04);
        border-radius: 12px;
        padding: 3px;
        border: 1px solid rgba(255,255,255,0.06);
    }
    .view-mode-btn {
        padding: 6px 14px;
        border-radius: 9px;
        border: 1px solid transparent;
        background: transparent;
        font-size: 12px;
    }
    .view-mode-btn:hover {
        background: rgba(255,255,255,0.04);
    }
    .view-mode-btn.active {
        background: rgba(254,202,87,0.12);
        border-color: rgba(254,202,87,0.25);
        color: #feca57;
    }

    /* View task cards: wider padding on desktop */
    .view-task-card .task {
        padding: 16px 20px;
        gap: 16px;
    }

    /* View group headers: slightly more refined */
    .view-group {
        margin-bottom: 24px;
    }
    .view-group-header {
        padding: 10px 4px;
    }
    .view-group-label {
        font-size: 13px;
    }

    /* View task location label: slightly larger on desktop */
    .view-task-location {
        font-size: 10px;
    }

    /* --- END STAGE 4 --- */

    /* --- STAGE 5: Settings & Other Screens --- */

    /* Settings: sticky header, smaller title */
    #settings-screen > .header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: transparent;
        padding-bottom: 16px;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .settings-title {
        margin-bottom: 0;
        padding: 16px 0 12px;
    }
    .settings-title h1 {
        font-size: 24px;
    }

    /* Settings cards: slightly wider padding on desktop */
    .settings-card {
        padding: 20px;
    }
    .settings-action-btn {
        padding: 14px;
    }
    .settings-link-btn {
        padding: 16px 4px;
    }

    /* Desktop: make SCREENS scroll (browser-edge scrollbar), not inner containers */
    #settings-screen,
    #archive-screen,
    #trash-screen,
    #cubby-screen,
    #views-screen,
    #room-screen {
        overflow-y: auto;
    }
    .settings-container,
    .archive-container,
    .trash-container,
    .tasks-container,
    .views-container,
    .cubbies-list {
        overflow-y: visible;
        padding-right: 0;
    }

    /* Archive/Trash: sticky header, smaller title */
    #archive-screen > .header,
    #trash-screen > .header {
        position: sticky;
        top: 0;
        z-index: 10;
        background: transparent;
        padding-bottom: 16px;
        margin-bottom: 0;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    #archive-screen .settings-title,
    #trash-screen .settings-title {
        padding: 16px 0 12px;
        margin-bottom: 0;
    }
    #archive-screen .settings-title h1,
    #trash-screen .settings-title h1 {
        font-size: 24px;
    }

    /* Archive/Trash items: wider padding */
    .archive-item {
        padding: 16px 20px;
    }

    /* Archive/Trash header max-width */
    #archive-screen > .header,
    #trash-screen > .header,
    #archive-screen .settings-title,
    #trash-screen .settings-title {
        width: 100%;
        max-width: 700px;
    }

    /* Cubbies Browse: sticky title, refined sizing */
    .cubbies-browse-title {
        padding: 8px 0 12px;
        margin-bottom: 0;
    }
    .cubbies-browse-title h1 {
        font-size: 24px;
    }

    /* Cubbies Browse: grid layout for workspace sections */
    .cubbies-browse-container {
        display: grid;
        grid-template-columns: repeat(2, 1fr);
        gap: 16px;
        align-items: start;
    }
    .cubbies-browse-section {
        margin-bottom: 0;
    }
    .cubbies-browse-add {
        grid-column: 1 / -1;
        margin-bottom: 0;
    }

    /* --- END STAGE 5 --- */

    .settings-title,
    .settings-container,
    #settings-container {
        width: 100%;
        max-width: 700px;
    }

    .archive-container,
    #archive-container,
    .trash-container,
    #trash-container {
        width: 100%;
        max-width: 700px;
    }

    /* Desktop search bar  hidden (sidebar has search) */
    #home-screen > .search-btn {
        display: none;
    }

    /* Hide workspaces section on desktop (sidebar shows them) */
    .home-section-wrapper[data-section-id="workspaces"] {
        display: none !important;
    }

    /* Hide logo on desktop */
    #home-screen > .logo {
        display: none;
    }

    /* Remove stats margin on desktop (flex gap handles spacing) */
    .dashboard-stats {
        margin-bottom: 0;
    }

    /* Show widget grid drag handle on desktop, hide individual section drag handles inside grid */
    .widget-grid-controls {
        display: flex !important;
        grid-column: 1 / -1;
    }
    .home-widget-grid .home-widget-card > .home-section-controls .home-section-drag-handle {
        display: none;
    }
    /* Remove individual section editing borders inside the grid on desktop */
    .home-widget-grid .home-widget-card.editing {
        padding: 0;
        background: none;
        border: none;
        margin-bottom: 0;
    }

    /* Widget grid: 2-column layout */
    .home-widget-grid {
        display: grid !important;
        grid-template-columns: 1fr 1fr;
        gap: 16px;
        width: 100%;
        max-width: 900px;
    }

    /* Widget card styling */
    .home-widget-card {
        background: rgba(255,255,255,0.02);
        border: 1px solid rgba(255,255,255,0.06);
        border-radius: 16px;
        padding: 20px;
        display: flex;
        flex-direction: column;
    }
    .home-widget-card:hover {
        border-color: rgba(255,255,255,0.09);
    }

    /* Widget card header */
    .widget-card-header {
        display: flex !important;
        align-items: center;
        gap: 8px;
        margin-bottom: 16px;
        padding-bottom: 12px;
        border-bottom: 1px solid rgba(255,255,255,0.06);
    }
    .widget-card-header svg {
        color: rgba(255,255,255,0.3);
        flex-shrink: 0;
    }
    .widget-card-header span {
        font-size: 13px;
        font-weight: 700;
        color: rgba(255,255,255,0.4);
        letter-spacing: 0.3px;
    }
    .desktop-only {
        display: flex !important;
    }

    /* Upcoming widget adjustments inside card */
    .home-widget-card .dashboard-upcoming {
        margin-bottom: 0;
    }
    .home-widget-card .dashboard-upcoming-header {
        display: none;
    }

    /* Quick actions adjustments inside card */
    .home-widget-card .dashboard-quick-actions {
        grid-template-columns: repeat(2, 1fr);
        gap: 10px;
        margin-bottom: 0;
    }
    .home-widget-card .quick-action-btn {
        padding: 16px 12px;
    }
}

/* ============================================ */
/* RESPONSIVE LAYOUT  MOBILE (<=768px) */
/* ============================================ */

@media (max-width: 768px) {
    /* Hide desktop sidebar, show as slide-out overlay */
    .app-sidebar {
        transform: translateX(-100%);
        z-index: 200;
        width: 280px;
        padding-top: env(safe-area-inset-top, 0px);
    }
    .app-sidebar.open {
        transform: translateX(0);
    }
    .sidebar-close-btn {
        display: flex;
    }

    /* Show bottom nav on mobile */
    .bottom-nav {
        /* default flex from JS showNavBar() */
    }

    /* Screens take full width */
    .screen {
        left: 0;
        width: 100%;
    }

    /* Mobile-optimized padding */
    #home-screen {
        padding: calc(var(--safe-top) + 12px) 16px var(--nav-height);
    }

    /* Stats grid: stack the "today" card, make others smaller */
    .dashboard-stats {
        grid-template-columns: 1fr 1fr 1fr 1fr;
        gap: 8px;
    }
    .dashboard-stat-card.today-stat {
        grid-column: 1 / -1;
    }

    /* Task cards full-width touch targets */
    .task {
        padding: 14px 12px;
    }
}

/* ============================================ */
/* LOCATION PICKER (for + Add modal) */
/* ============================================ */

.location-picker {
    margin-bottom: 16px;
}

.location-picker-label {
    font-size: 12px;
    color: rgba(255, 255, 255, 0.4);
    font-weight: 600;
    letter-spacing: 0.5px;
    margin-bottom: 8px;
}

.location-picker-btn {
    display: flex;
    align-items: center;
    gap: 8px;
    width: 100%;
    padding: 12px 14px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 12px;
    color: #fff;
    font-family: inherit;
    font-size: 14px;
    font-weight: 500;
    cursor: pointer;
    transition: all 0.2s ease;
    text-align: left;
}

.location-picker-btn:hover {
    background: rgba(255, 255, 255, 0.08);
}

.location-picker-btn .location-icon {
    color: rgba(255, 255, 255, 0.4);
    flex-shrink: 0;
}

.location-picker-btn .location-path {
    flex: 1;
    white-space: nowrap;
    overflow: hidden;
    text-overflow: ellipsis;
}

.location-picker-btn .location-chevron {
    color: rgba(255, 255, 255, 0.3);
    flex-shrink: 0;
    transition: transform 0.2s ease;
}

.location-picker-btn.open .location-chevron {
    transform: rotate(180deg);
}

/* Expandable location list */
.location-picker-list {
    max-height: 0;
    overflow: hidden;
    transition: max-height 0.3s ease;
    margin-top: 0;
}

.location-picker-list.open {
    max-height: 250px;
    overflow-y: auto;
    margin-top: 8px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    border-radius: 12px;
}

.location-picker-room {
    padding: 10px 14px;
    font-size: 11px;
    font-weight: 700;
    text-transform: lowercase;
    letter-spacing: 0.5px;
    color: rgba(255, 255, 255, 0.35);
    background: rgba(255, 255, 255, 0.02);
}

.location-picker-item {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 14px 10px 24px;
    font-size: 14px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.7);
    cursor: pointer;
    transition: background 0.15s ease;
}

.location-picker-item:hover {
    background: rgba(255, 255, 255, 0.05);
}

.location-picker-item.selected {
    color: #C77DFF;
    background: rgba(199, 125, 255, 0.08);
}

.location-picker-item .picker-color-dot {
    width: 8px;
    height: 8px;
    border-radius: 50%;
    flex-shrink: 0;
}

.location-picker-create {
    display: flex;
    align-items: center;
    gap: 8px;
    padding: 10px 14px 10px 24px;
    font-size: 13px;
    font-weight: 600;
    color: rgba(199, 125, 255, 0.7);
    cursor: pointer;
    transition: background 0.15s ease;
    border-top: 1px solid rgba(255, 255, 255, 0.04);
}

.location-picker-create:hover {
    background: rgba(199, 125, 255, 0.08);
}

.location-picker-create.indent {
    padding-left: 44px;
    border-top: none;
}

/* ============================================ */
/* SETTINGS SCREEN STYLES */
/* ============================================ */

#settings-screen {
    padding: calc(var(--safe-top) + 12px) 16px var(--nav-height);
    background: #0a0a0f;
    overflow: hidden;
}
.settings-title {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 24px;
}
.settings-title h1 {
    font-size: 32px;
    font-weight: 800;
}
.settings-container {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 40px;
    padding-right: 12px;
}

/* Settings sections */
.settings-section {
    margin-bottom: 28px;
}
.settings-section-header {
    font-size: 12px;
    font-weight: 700;
    letter-spacing: 0.5px;
    color: rgba(255, 255, 255, 0.35);
    margin-bottom: 10px;
    padding-left: 4px;
}
.settings-description {
    font-size: 13px;
    color: rgba(255, 255, 255, 0.35);
    margin-bottom: 12px;
    padding-left: 4px;
    line-height: 1.4;
}
.settings-card {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 16px;
    padding: 16px;
}

/* User row */
.settings-user-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}
.settings-user-icon {
    width: 40px;
    height: 40px;
    border-radius: 12px;
    background: rgba(199, 125, 255, 0.15);
    display: flex;
    align-items: center;
    justify-content: center;
    color: #C77DFF;
    flex-shrink: 0;
}
.settings-user-info {
    font-size: 15px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.8);
    word-break: break-all;
}
.settings-name-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-bottom: 12px;
}
.settings-name-label {
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.5);
    flex-shrink: 0;
}
.settings-name-input {
    flex: 1;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.06);
    border: 1px solid rgba(255, 255, 255, 0.1);
    border-radius: 10px;
    color: rgba(255, 255, 255, 0.9);
    font-family: inherit;
    font-size: 14px;
    font-weight: 500;
    outline: none;
    transition: border-color 0.2s ease;
}
.settings-name-input:focus {
    border-color: rgba(199, 125, 255, 0.5);
}
.settings-name-input::placeholder {
    color: rgba(255, 255, 255, 0.25);
}

/* Action buttons */
.settings-action-btn {
    display: flex;
    align-items: center;
    justify-content: center;
    gap: 8px;
    width: 100%;
    padding: 12px;
    border-radius: 12px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    background: rgba(255, 255, 255, 0.03);
    color: rgba(255, 255, 255, 0.5);
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}
.settings-action-btn:hover {
    background: rgba(255, 255, 255, 0.06);
}
.settings-action-btn:active {
    transform: scale(0.98);
}
.settings-signout {
    color: #ff6b6b;
    border-color: rgba(255, 107, 107, 0.15);
}
.settings-signout:hover {
    background: rgba(255, 107, 107, 0.08);
}

/* Link buttons (Archive, Trash) */
.settings-link-btn {
    display: flex;
    align-items: center;
    gap: 12px;
    width: 100%;
    padding: 14px 4px;
    background: none;
    border: none;
    border-bottom: 1px solid rgba(255, 255, 255, 0.04);
    color: rgba(255, 255, 255, 0.7);
    font-family: inherit;
    font-size: 15px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
    text-align: left;
}
.settings-link-btn:last-child {
    border-bottom: none;
}
.settings-link-btn:hover {
    color: rgba(255, 255, 255, 0.9);
}
.settings-link-btn:active {
    transform: scale(0.99);
}
.settings-link-btn svg:first-child {
    opacity: 0.5;
    flex-shrink: 0;
}
.settings-link-btn span:first-of-type {
    flex: 1;
}
.settings-link-count {
    font-size: 12px;
    font-weight: 700;
    padding: 2px 8px;
    border-radius: 10px;
    background: rgba(255, 255, 255, 0.08);
    color: rgba(255, 255, 255, 0.4);
}
.settings-link-chevron {
    opacity: 0.3;
    flex-shrink: 0;
}

/* Mode toggle (Duration / Date Change) */
.settings-toggle-row {
    display: flex;
    gap: 8px;
    margin-bottom: 14px;
}
.settings-toggle-row.compact {
    margin-bottom: 0;
}
.settings-mode-btn {
    flex: 1;
    padding: 10px 12px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.1);
    background: rgba(255, 255, 255, 0.03);
    color: rgba(255, 255, 255, 0.4);
    font-family: inherit;
    font-size: 13px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.2s ease;
}
.settings-mode-btn:active {
    transform: scale(0.97);
}
.settings-mode-btn.active {
    border-color: rgba(199, 125, 255, 0.4);
    background: rgba(199, 125, 255, 0.1);
    color: #C77DFF;
}

/* Option grid */
.settings-option-grid {
    display: grid;
    grid-template-columns: repeat(4, 1fr);
    gap: 8px;
}
.settings-option-btn {
    padding: 10px 8px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    background: rgba(255, 255, 255, 0.02);
    color: rgba(255, 255, 255, 0.45);
    font-family: inherit;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
    text-align: center;
}
.settings-option-btn:active {
    transform: scale(0.95);
}
.settings-option-btn.active {
    border-color: rgba(91, 142, 255, 0.4);
    background: rgba(91, 142, 255, 0.12);
    color: #5B8EFF;
}

/* Custom days input */
.settings-custom-row {
    display: flex;
    align-items: center;
    gap: 12px;
    margin-top: 12px;
}
.settings-custom-row label {
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.5);
    white-space: nowrap;
}
.settings-custom-row input[type="number"] {
    width: 80px;
    padding: 8px 12px;
    background: rgba(255, 255, 255, 0.05);
    border: 1px solid rgba(255, 255, 255, 0.12);
    border-radius: 8px;
    color: #fff;
    font-family: inherit;
    font-size: 14px;
    font-weight: 600;
    outline: none;
}
.settings-custom-row input[type="number"]:focus {
    border-color: rgba(255, 255, 255, 0.25);
}

/* Version */
.settings-version {
    text-align: center;
    padding: 30px 20px;
    font-size: 12px;
    font-weight: 700;
    color: rgba(255, 255, 255, 0.1);
    letter-spacing: 2px;
}

/* ============================================ */
/* ARCHIVE & TRASH SCREEN STYLES */
/* ============================================ */

#archive-screen {
    padding: calc(var(--safe-top) + 12px) 16px var(--nav-height);
    background: #0a0a0f;
    overflow: hidden;
}
#trash-screen {
    padding: calc(var(--safe-top) + 12px) 16px var(--nav-height);
    background: #0a0a0f;
    overflow: hidden;
}
.archive-container, .trash-container {
    flex: 1;
    overflow-y: auto;
    padding-bottom: 40px;
    padding-right: 12px;
}

/* Empty state */
.archive-empty {
    padding: 60px 20px;
    text-align: center;
    color: rgba(255, 255, 255, 0.25);
    font-size: 15px;
    font-weight: 500;
}

/* Summary row */
.archive-summary {
    display: flex;
    align-items: center;
    justify-content: space-between;
    padding: 8px 4px 16px;
    font-size: 13px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.4);
}

/* Empty trash button */
.empty-trash-btn {
    padding: 8px 16px;
    border-radius: 10px;
    border: 1px solid rgba(255, 107, 107, 0.25);
    background: rgba(255, 107, 107, 0.08);
    color: #ff6b6b;
    font-family: inherit;
    font-size: 12px;
    font-weight: 700;
    cursor: pointer;
    transition: all 0.2s ease;
}
.empty-trash-btn:hover {
    background: rgba(255, 107, 107, 0.15);
}
.empty-trash-btn:active {
    transform: scale(0.95);
}

/* Archive/Trash item card */
.archive-item {
    background: rgba(255, 255, 255, 0.03);
    border: 1px solid rgba(255, 255, 255, 0.06);
    border-radius: 14px;
    padding: 14px 16px;
    margin-bottom: 10px;
}
.archive-item-type {
    font-size: 10px;
    font-weight: 700;
    letter-spacing: 0.5px;
    color: rgba(255, 255, 255, 0.3);
    margin-bottom: 4px;
}
.archive-item-name {
    font-size: 15px;
    font-weight: 600;
    color: rgba(255, 255, 255, 0.85);
    margin-bottom: 4px;
    word-break: break-word;
}
.archive-item-source {
    font-size: 11px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.25);
    margin-bottom: 4px;
}
.archive-item-date {
    font-size: 11px;
    font-weight: 500;
    color: rgba(255, 255, 255, 0.2);
    margin-bottom: 10px;
}

/* Item actions */
.archive-item-actions {
    display: flex;
    gap: 8px;
}
.archive-action-btn {
    display: flex;
    align-items: center;
    gap: 6px;
    padding: 8px 14px;
    border-radius: 10px;
    border: 1px solid rgba(255, 255, 255, 0.08);
    background: rgba(255, 255, 255, 0.03);
    background: rgba(255, 255, 255, 0.03);
    color: rgba(255, 255, 255, 0.5);
    font-family: inherit;
    font-size: 12px;
    font-weight: 600;
    cursor: pointer;
    transition: all 0.15s ease;
}
.archive-action-btn:active {
    transform: scale(0.95);
}
.archive-action-btn.restore {
    color: #5AE890;
    border-color: rgba(90, 232, 144, 0.15);
}
.archive-action-btn.restore:hover {
    background: rgba(90, 232, 144, 0.08);
}
.archive-action-btn.delete {
    color: #ff6b6b;
    border-color: rgba(255, 107, 107, 0.15);
}
.archive-action-btn.delete:hover {
    background: rgba(255, 107, 107, 0.08);
}

/* ============================================ */
/* COLOR EDITOR */
/* ============================================ */
/* Theme color customization indicator */
.cubby-color-swatch.customized {
    position: relative;
}
.color-custom-indicator {
    position: absolute;
    top: -2px;
    right: -2px;
    width: 8px;
    height: 8px;
    border-radius: 50%;
    background: #fff;
    border: 1.5px solid #0a0a0f;
    box-shadow: 0 1px 3px rgba(0, 0, 0, 0.3);
}

/* ============================================ */
/* GLOBAL HOVER & CLICK EFFECTS */
/* ============================================ */

/* Explicit hover states for dark/transparent elements */
.back-btn:hover {
    background: rgba(255, 255, 255, 0.1);
    border-color: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.85);
}
.settings-option-btn:hover {
    background: rgba(255, 255, 255, 0.06);
    border-color: rgba(255, 255, 255, 0.15);
    color: rgba(255, 255, 255, 0.65);
}
.settings-name-input:hover {
    border-color: rgba(255, 255, 255, 0.25);
    background: rgba(255, 255, 255, 0.08);
}
input[type="text"]:hover,
input[type="date"]:hover,
textarea:hover {
    border-color: rgba(255, 255, 255, 0.2);
}
.empty-trash-btn:hover {
    filter: brightness(1.2) saturate(1.25);
    transition: filter 0.06s ease;
}

/* Hover: brighten and saturate  near-instant transition */
.room-card:hover,
.cubby-card:hover,
.task-card:hover,
.back-btn:hover,
.signout-btn:hover,
.settings-option-btn:hover,
.settings-mode-btn:hover,
.settings-link-btn:hover,
.settings-action-btn:hover,
.add-room-btn:hover,
.add-cubby-btn:hover,
.add-task-btn:hover,
.views-btn:hover,
.search-btn:hover,
.filter-btn:hover,
.view-filter-btn:hover,
.view-mode-btn:hover,
.modal-btn:hover,
.room-more-btn:hover,
.kebab-btn:hover,
.header-search-btn:hover,
.archive-action-btn:hover,
.color-editor-swatch:hover {
    filter: brightness(1.2) saturate(1.25);
    transition: filter 0.06s ease;
}

/* Click pop: quick shrink, darken, then spring back */
@keyframes clickPop {
    0% { transform: scale(1); filter: brightness(1); }
    40% { transform: scale(0.93); filter: brightness(0.85); }
    100% { transform: scale(1); filter: brightness(1); }
}

.task-card:active,
.settings-link-btn:active,
.add-room-btn:active,
.add-cubby-btn:active,
.add-task-btn:active,
.views-btn:active,
.search-btn:active {
    animation: clickPop 0.25s ease;
}

.back-btn:active,
.settings-option-btn:active,
.settings-mode-btn:active,
.settings-action-btn:active,
.filter-btn:active,
.view-filter-btn:active,
.view-mode-btn:active,
.modal-btn:active,
.signout-btn:active,
.room-more-btn:active,
.kebab-btn:active,
.header-search-btn:active,
.archive-action-btn:active {
    transform: scale(0.93);
    filter: brightness(0.85);
    transition: transform 0.08s ease, filter 0.08s ease;
}

/* ============================================
   ICON PICKER
   ============================================ */

.cubby-icon-row {
    display: flex;
    flex-direction: column;
    gap: 8px;
}

.cubby-icon-row label {
    font-size: 13px;
    color: #aaa;
}

.cubby-icon-options {
    display: grid;
    grid-template-columns: repeat(8, 1fr);
    gap: 6px;
    max-height: 240px;
    overflow-y: auto;
    padding: 8px;
    background: rgba(0,0,0,0.2);
    border-radius: 10px;
    border: 1px solid rgba(255,255,255,0.06);
}

.icon-option {
    width: 40px;
    height: 40px;
    display: flex;
    align-items: center;
    justify-content: center;
    border-radius: 8px;
    cursor: pointer;
    background: rgba(255,255,255,0.05);
    border: 2px solid transparent;
    transition: all 0.15s ease;
    color: #aaa;
}

.icon-option svg {
    width: 20px;
    height: 20px;
}

.icon-option:hover {
    background: rgba(255,255,255,0.1);
    color: #fff;
}

.icon-option.selected {
    border-color: var(--accent, #6C9CFC);
    background: rgba(108,156,252,0.15);
    color: #fff;
}

.icon-option-none {
    font-size: 18px;
    color: #666;
}

#icon-modal .modal-content {
    max-width: 400px;
}

#icon-modal .modal-content h2 {
    margin-bottom: 12px;
}

/* Icon display in browse/cards */
.cubby-icon-display {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 22px;
    height: 22px;
    flex-shrink: 0;
    color: inherit;
    opacity: 0.85;
}

.cubby-icon-display svg {
    width: 16px;
    height: 16px;
}

.room-card-icon {
    display: flex;
    align-items: center;
    justify-content: center;
    width: 28px;
    height: 28px;
    flex-shrink: 0;
    margin-right: 4px;
    opacity: 0.7;
}

.room-card-icon svg {
    width: 20px;
    height: 20px;
}
